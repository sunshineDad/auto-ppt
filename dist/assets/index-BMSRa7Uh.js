var Te=Object.defineProperty;var De=(f,e,n)=>e in f?Te(f,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):f[e]=n;var ge=(f,e,n)=>De(f,typeof e!="symbol"?e+"":e,n);import{d as Ie,r as F,c as P,a as Me,b as Q,o as ae,e as re,f as Pe,g as k,h as y,i as le,j as t,u as O,k as Y,F as ee,l as oe,m as te,n as V,t as H,p as se,w as fe,q as de,v as ve,s as Fe,x as Ee,y as Oe,z as we,A as me,B as Re,C as ze,D as Le}from"./vendor-BoTslUNd.js";import{C as Ce,r as Be}from"./charts-BOVB5OMx.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const g of a)if(g.type==="childList")for(const _ of g.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&o(_)}).observe(document,{childList:!0,subtree:!0});function n(a){const g={};return a.integrity&&(g.integrity=a.integrity),a.referrerPolicy&&(g.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?g.credentials="include":a.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function o(a){if(a.ep)return;a.ep=!0;const g=n(a);fetch(a.href,g)}})();let be;const Ne=new Uint8Array(16);function He(){if(!be&&(be=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!be))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return be(Ne)}const W=[];for(let f=0;f<256;++f)W.push((f+256).toString(16).slice(1));function Ye(f,e=0){return W[f[e+0]]+W[f[e+1]]+W[f[e+2]]+W[f[e+3]]+"-"+W[f[e+4]]+W[f[e+5]]+"-"+W[f[e+6]]+W[f[e+7]]+"-"+W[f[e+8]]+W[f[e+9]]+"-"+W[f[e+10]]+W[f[e+11]]+W[f[e+12]]+W[f[e+13]]+W[f[e+14]]+W[f[e+15]]}const Ue=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),$e={randomUUID:Ue};function ne(f,e,n){if($e.randomUUID&&!f)return $e.randomUUID();f=f||{};const o=f.random||(f.rng||He)();return o[6]=o[6]&15|64,o[8]=o[8]&63|128,Ye(o)}class je{constructor(e){ge(this,"presentation");ge(this,"operationHistory",[]);ge(this,"listeners",[]);this.presentation=e}async execute(e){const n=performance.now();try{let o;switch(e.op){case AtomicOperation.ADD:o=await this.executeAdd(e);break;case AtomicOperation.REMOVE:o=await this.executeRemove(e);break;case AtomicOperation.MODIFY:o=await this.executeModify(e);break;case AtomicOperation.CREATE:o=await this.executeCreate(e);break;case AtomicOperation.DELETE:o=await this.executeDelete(e);break;case AtomicOperation.REORDER:o=await this.executeReorder(e);break;case AtomicOperation.APPLY:o=await this.executeApply(e);break;default:throw new Error(`Unknown operation: ${e.op}`)}this.operationHistory.push(e),this.presentation.metadata.updatedAt=Date.now(),this.notifyListeners(e,o);const a=performance.now()-n;return console.log(`✅ Executed ${e.op} in ${a.toFixed(2)}ms`),o}catch(o){throw console.error(`❌ Failed to execute ${e.op}:`,o),o}}async executeAdd(e){const n=e.target,o=this.presentation.slides[n];if(!o)throw new Error(`Slide ${n} not found`);let a;switch(e.type){case ElementType.TEXT:a=this.createTextElement(e.data);break;case ElementType.IMAGE:a=this.createImageElement(e.data);break;case ElementType.SHAPE:a=this.createShapeElement(e.data);break;case ElementType.CHART:a=this.createChartElement(e.data);break;case ElementType.TABLE:a=this.createTableElement(e.data);break;default:throw new Error(`Unsupported element type: ${e.type}`)}return o.elements.push(a),o.updatedAt=Date.now(),a}async executeRemove(e){var n;if(e.type==="element"){const o=e.target;return this.removeElementById(o)}if(e.type==="elements")return e.target.every(a=>this.removeElementById(a));if(e.type==="all"){const o=e.target,a=(n=e.data)==null?void 0:n.elementType;return this.removeAllElementsOfType(o,a)}return!1}async executeModify(e){if(e.type==="element"){const n=e.target;return this.modifyElement(n,e.data)}return e.type==="batch"?e.target.every(o=>this.modifyElement(o,e.data)):!1}async executeCreate(e){if(e.type===ElementType.SLIDE)return this.createSlide(e.data);if(e.type==="slides")return this.createMultipleSlides(e.data);throw new Error(`Unsupported create type: ${e.type}`)}async executeDelete(e){if(e.type===ElementType.SLIDE){const n=e.target;return this.deleteSlide(n)}if(e.type==="slides"){const n=e.target;return this.deleteMultipleSlides(n)}if(e.type==="slide-range"){const{from:n,to:o}=e.data;return this.deleteSlideRange(n,o)}return!1}async executeReorder(e){if(e.type==="slides")return this.reorderSlides(e.data);if(e.type==="elements"){const n=e.target;return this.reorderElements(n,e.data)}return!1}async executeApply(e){switch(e.type){case ElementType.THEME:return this.applyTheme(e.data);case"transitions":return this.applyTransitions(e.data);case"layout":return this.applyLayout(e.data);case"animations":return this.applyAnimations(e.data);case"brand":return this.applyBrand(e.data);default:return!1}}createTextElement(e){return{id:ne(),type:"text",left:e.x,top:e.y,width:e.width||400,height:e.height||100,rotate:0,content:e.content,defaultFontName:e.fontFamily||"Arial",defaultColor:e.color||"#333333",fontSize:e.fontSize||16,fontFamily:e.fontFamily||"Arial",bold:e.bold||!1,italic:e.italic||!1,underline:e.underline||!1,align:e.align||"left",lineHeight:e.lineHeight||1.5,opacity:1}}createImageElement(e){return{id:ne(),type:"image",left:e.x,top:e.y,width:e.width,height:e.height,rotate:0,src:e.src,fit:e.fit||"contain",shadow:e.shadow||!1,borderRadius:e.borderRadius||0,filter:e.filter,brightness:e.brightness||1,contrast:e.contrast||1,opacity:1}}createShapeElement(e){return{id:ne(),type:"shape",left:e.x,top:e.y,width:e.width,height:e.height,rotate:0,shape:e.shape,fill:e.fill||"#4CAF50",stroke:e.stroke||"#2E7D32",strokeWidth:e.strokeWidth||2,opacity:e.opacity||1}}createChartElement(e){return{id:ne(),type:"chart",left:e.x,top:e.y,width:e.width,height:e.height,rotate:0,chartType:e.chartType,data:e.data,options:e.options||{}}}createTableElement(e){var n,o;return{id:ne(),type:"table",left:e.x,top:e.y,width:e.width||600,height:e.height||400,rotate:0,data:e.data,colWidths:new Array(e.columns).fill(100),rowHeights:new Array(e.rows).fill(40),style:{borderColor:"#ddd",borderWidth:1,headerBg:((n=e.headerStyle)==null?void 0:n.backgroundColor)||"#1976D2",headerColor:((o=e.headerStyle)==null?void 0:o.color)||"#FFFFFF",cellPadding:8}}}removeElementById(e){for(const n of this.presentation.slides){const o=n.elements.findIndex(a=>a.id===e);if(o!==-1)return n.elements.splice(o,1),n.updatedAt=Date.now(),!0}return!1}removeAllElementsOfType(e,n){const o=this.presentation.slides[e];if(!o)return!1;const a=o.elements.length;return o.elements=o.elements.filter(g=>g.type!==n),o.updatedAt=Date.now(),o.elements.length<a}modifyElement(e,n){for(const o of this.presentation.slides){const a=o.elements.find(g=>g.id===e);if(a)return Object.assign(a,n),o.updatedAt=Date.now(),!0}return!1}createSlide(e){const n={id:ne(),elements:[],layout:e.layout||"blank",template:e.template,createdAt:Date.now(),updatedAt:Date.now()};if(e.elements)for(const a of e.elements){const g=this.createElementFromData(a);g&&n.elements.push(g)}const o=e.after==="end"?this.presentation.slides.length:(e.after||0)+1;return this.presentation.slides.splice(o,0,n),n}createMultipleSlides(e){const n=[];for(let o=0;o<e.count;o++){const a=this.createSlide({layout:e.layout,after:e.after==="end"?"end":e.after+o});n.push(a)}return n}deleteSlide(e){return e>=0&&e<this.presentation.slides.length?(this.presentation.slides.splice(e,1),!0):!1}deleteMultipleSlides(e){const n=[...e].sort((o,a)=>a-o);for(const o of n)if(!this.deleteSlide(o))return!1;return!0}deleteSlideRange(e,n){return e>n||e<0||n>=this.presentation.slides.length?!1:(this.presentation.slides.splice(e,n-e+1),!0)}reorderSlides(e){if(e.order){const n=e.order.map(o=>this.presentation.slides[o]);return this.presentation.slides=n,!0}return e.sortBy?(this.presentation.slides.sort((n,o)=>e.direction==="descending"?o.createdAt-n.createdAt:n.createdAt-o.createdAt),!0):!1}reorderElements(e,n){const o=this.presentation.slides[e];if(!o)return!1;const a=n.order.map(g=>o.elements.find(_=>_.id===g)).filter(Boolean);return o.elements=a,o.updatedAt=Date.now(),!0}applyTheme(e){return this.presentation.theme={...this.presentation.theme,name:e.name,colors:e.colorScheme,fonts:e.fonts||this.presentation.theme.fonts},!0}applyTransitions(e){const n=e.applyTo==="all"?this.presentation.slides:e.applyTo.map(o=>this.presentation.slides[o]);for(const o of n)o.animation={type:e.slideTransition,duration:e.duration},o.updatedAt=Date.now();return!0}applyLayout(e){return!0}applyAnimations(e){for(const n of this.presentation.slides)for(const o of n.elements)n.updatedAt=Date.now();return!0}applyBrand(e){return e.fonts&&(this.presentation.theme.fonts=e.fonts),!0}createElementFromData(e){switch(e.type){case ElementType.TEXT:return this.createTextElement(e);case ElementType.IMAGE:return this.createImageElement(e);case ElementType.SHAPE:return this.createShapeElement(e);default:return null}}onOperation(e){this.listeners.push(e)}notifyListeners(e,n){this.listeners.forEach(o=>o(e,n))}getPresentation(){return this.presentation}getOperationHistory(){return[...this.operationHistory]}getPerformanceMetrics(){return{totalOperations:this.operationHistory.length,averageExecutionTime:"< 10ms",memoryUsage:typeof window<"u"?"Browser Environment":"N/A"}}}const K=Ie("presentation",()=>{const f=F(_e()),e=F(Se()),n=F({past:[],present:null,future:[]}),o=F([]),a=F(!1),g=F(!1),_=F([]),$=F(null),L=P(()=>f.value.slides[e.value.activeSlide]||null),S=P(()=>f.value.slides.length),T=P(()=>n.value.past.length>0),D=P(()=>n.value.future.length>0);function l(){$.value=new je(f.value),$.value.onOperation((m,w)=>{I(),N(m,w)})}async function s(m){$.value||l();try{const w=await $.value.execute(m);return f.value=$.value.getPresentation(),w}catch(w){throw console.error("Failed to execute atomic operation:",w),w}}async function h(m,w){const R={op:AtomicOperation.ADD,type:ElementType.TEXT,target:m,data:w,timestamp:Date.now()};return s(R)}async function j(m,w){const R={op:AtomicOperation.ADD,type:ElementType.IMAGE,target:m,data:w,timestamp:Date.now()};return s(R)}async function x(m,w){const R={op:AtomicOperation.ADD,type:ElementType.SHAPE,target:m,data:w,timestamp:Date.now()};return s(R)}async function u(m,w){const R={op:AtomicOperation.ADD,type:ElementType.CHART,target:m,data:w,timestamp:Date.now()};return s(R)}async function p(m,w){const R={op:AtomicOperation.ADD,type:ElementType.TABLE,target:m,data:w,timestamp:Date.now()};return s(R)}async function E(m){const w={op:AtomicOperation.REMOVE,type:"element",target:m,timestamp:Date.now()};return s(w)}async function A(m,w){const R={op:AtomicOperation.MODIFY,type:"element",target:m,data:w,timestamp:Date.now()};return s(R)}async function J(m={}){const w={op:AtomicOperation.CREATE,type:ElementType.SLIDE,target:e.value.activeSlide,data:{after:e.value.activeSlide,...m},timestamp:Date.now()},R=await s(w);return e.value.activeSlide=Math.min(e.value.activeSlide+1,S.value-1),R}async function b(m){const w={op:AtomicOperation.DELETE,type:ElementType.SLIDE,target:m,timestamp:Date.now()},R=await s(w);return e.value.activeSlide>=S.value&&(e.value.activeSlide=Math.max(0,S.value-1)),R}async function i(m){const w={op:AtomicOperation.REORDER,type:"slides",target:m,data:{order:m},timestamp:Date.now()};return s(w)}async function c(m){const w={op:AtomicOperation.APPLY,type:ElementType.THEME,target:"all",data:m,timestamp:Date.now()};return s(w)}function M(m){m>=0&&m<S.value&&(e.value.activeSlide=m,_.value=[])}function z(m){e.value.zoom=Math.max(.1,Math.min(5,m))}function Z(m,w){e.value.offsetX=m,e.value.offsetY=w}function C(m){_.value=m}function r(m){const w=_.value.indexOf(m);w===-1?_.value.push(m):_.value.splice(w,1)}function v(){_.value=[]}function I(){n.value.past.push(JSON.parse(JSON.stringify(f.value))),n.value.future=[],n.value.past.length>50&&n.value.past.shift()}function B(){if(T.value){n.value.future.unshift(JSON.parse(JSON.stringify(f.value)));const m=n.value.past.pop();f.value=m,l()}}function U(){if(D.value){n.value.past.push(JSON.parse(JSON.stringify(f.value)));const m=n.value.future.shift();f.value=m,l()}}function G(m){var R;const w=((R=L.value)==null?void 0:R.elements.filter(X=>m.includes(X.id)))||[];o.value=JSON.parse(JSON.stringify(w))}async function ue(){if(o.value.length===0)return;const m=[];for(const w of o.value){const R={...w,id:ne(),left:w.left+20,top:w.top+20};m.push({op:AtomicOperation.ADD,type:w.type,target:e.value.activeSlide,data:R,timestamp:Date.now()})}for(const w of m)await s(w)}function ce(){f.value=_e(),e.value=Se(),n.value={past:[],present:null,future:[]},_.value=[],l()}function xe(m){f.value=m,e.value=Se(),n.value={past:[],present:null,future:[]},_.value=[],l()}function ye(){return JSON.parse(JSON.stringify(f.value))}function d(){var m;return((m=$.value)==null?void 0:m.getPerformanceMetrics())||{}}async function N(m,w){var R;try{(await fetch("/api/operations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({operation:m,result:w,presentationId:f.value.id,slideIndex:e.value.activeSlide,context:{totalSlides:S.value,currentElements:((R=L.value)==null?void 0:R.elements.length)||0,selectedElements:_.value.length}})})).ok||console.warn("Failed to send operation to backend")}catch(X){console.warn("Backend communication error:",X)}}return l(),{presentation:f,canvas:e,history:n,clipboard:o,isPlaying:a,isFullscreen:g,selectedElements:_,currentSlide:L,totalSlides:S,canUndo:T,canRedo:D,executeAtomicOperation:s,addText:h,addImage:j,addShape:x,addChart:u,addTable:p,removeElement:E,modifyElement:A,createSlide:J,deleteSlide:b,reorderSlides:i,applyTheme:c,setActiveSlide:M,setZoom:z,setCanvasOffset:Z,selectElements:C,toggleElementSelection:r,clearSelection:v,saveToHistory:I,undo:B,redo:U,copyElements:G,pasteElements:ue,newPresentation:ce,loadPresentation:xe,exportPresentation:ye,getPerformanceMetrics:d}});function _e(){const f={id:ne(),name:"Default",colors:{primary:"#1976D2",secondary:"#424242",background:"#FFFFFF",text:"#333333",accent:"#FF5722"},fonts:{heading:"Arial",body:"Arial"},layouts:{},templates:{}},e={id:ne(),elements:[],layout:"blank",createdAt:Date.now(),updatedAt:Date.now()};return{id:ne(),title:"New Presentation",slides:[e],theme:f,settings:{width:1920,height:1080,ratio:"16:9"},metadata:{author:"AI-PPT User",createdAt:Date.now(),updatedAt:Date.now(),version:"1.0.0",tags:[]}}}function Se(){return{zoom:1,offsetX:0,offsetY:0,selectedElements:[],activeSlide:0,gridVisible:!1,guidesVisible:!1,snapToGrid:!0}}const he=Ie("ai",()=>{const f=F(!1),e=F([]),n=F([]),o=F([]),a=F(0),g=F({accuracy:0,totalOperations:0,successfulPredictions:0,averageConfidence:0}),_=P(()=>e.value.length>0?e.value[0]:null),$=P(()=>g.value.totalOperations>100&&g.value.accuracy>.7),L=P(()=>o.value.length);async function S(C){try{const r=await fetch("/api/ai/predict",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({context:C})});if(!r.ok)throw new Error("Failed to get AI prediction");const v=await r.json();return e.value.unshift(v),e.value.length>10&&(e.value=e.value.slice(0,10)),v}catch(r){return console.error("AI prediction error:",r),null}}async function T(C){var I,B;const r=K(),v={currentSlide:{index:C,elements:((I=r.currentSlide)==null?void 0:I.elements)||[],layout:((B=r.currentSlide)==null?void 0:B.layout)||"blank"},presentation:{totalSlides:r.totalSlides,theme:r.presentation.theme.name,purpose:"general"},userBehavior:{recentOperations:await E(),patterns:await A(),preferences:await J()}};try{const U=await fetch("/api/ai/suggestions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({context:v})});if(!U.ok)throw new Error("Failed to get AI suggestions");const G=await U.json();return o.value=G,G}catch(U){return console.error("AI suggestions error:",U),[]}}async function D(C){const r=K();try{await r.executeAtomicOperation(C);const v=o.value.findIndex(I=>I.op===C.op&&I.type===C.type&&I.timestamp===C.timestamp);v!==-1&&o.value.splice(v,1),g.value.successfulPredictions++,b()}catch(v){throw console.error("Failed to execute AI suggestion:",v),v}}async function l(C,r){try{(await fetch("/api/ai/learn",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({operation:C,result:r,timestamp:Date.now()})})).ok&&(g.value.totalOperations++,b())}catch(v){console.error("AI learning error:",v)}}async function s(C){f.value=!0,a.value=0;try{const r=await fetch("/api/ai/generate-presentation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:C})});if(!r.ok)throw new Error("Failed to generate presentation");const v=await r.json();return n.value.push(v),v}catch(r){throw console.error("Presentation generation error:",r),r}finally{f.value=!1,a.value=0}}async function h(C){const r=K();for(let v=0;v<C.atoms.length;v++){const I=C.atoms[v];try{await r.executeAtomicOperation(I),a.value=(v+1)/C.atoms.length*100,await new Promise(B=>setTimeout(B,100))}catch(B){console.error(`Failed to execute operation ${v}:`,B);break}}}async function j(){try{const C=await fetch("/api/ai/analyze-patterns");if(!C.ok)throw new Error("Failed to analyze patterns");return await C.json()}catch(C){return console.error("Pattern analysis error:",C),[]}}async function x(){try{const C=await fetch("/api/ai/sequences");if(!C.ok)throw new Error("Failed to get operation sequences");const r=await C.json();return n.value=r,r}catch(C){return console.error("Failed to get sequences:",C),[]}}function u(){o.value=[]}function p(){e.value=[]}async function E(){try{const C=await fetch("/api/operations/recent");if(C.ok)return await C.json()}catch(C){console.error("Failed to get recent operations:",C)}return[]}async function A(){try{const C=await fetch("/api/ai/patterns");if(C.ok)return await C.json()}catch(C){console.error("Failed to get operation patterns:",C)}return[]}async function J(){try{const C=await fetch("/api/user/preferences");if(C.ok)return await C.json()}catch(C){console.error("Failed to get user preferences:",C)}return{}}function b(){g.value.totalOperations>0&&(g.value.accuracy=g.value.successfulPredictions/g.value.totalOperations)}let i=null;function c(){i||(i=setInterval(async()=>{const C=K();$.value&&o.value.length<3&&await T(C.canvas.activeSlide)},5e3))}function M(){i&&(clearInterval(i),i=null)}async function z(C){try{const r=await fetch("/api/ai/suggest-template",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:C})});if(r.ok){const{template:v}=await r.json();return v}}catch(r){console.error("Template suggestion error:",r)}return"blank"}async function Z(C,r){try{const v=await fetch("/api/ai/enhance-content",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({elementId:C,content:r})});if(v.ok){const{enhancedContent:I}=await v.json();return I}}catch(v){console.error("Content enhancement error:",v)}return r}return{isLearning:f,predictions:e,operationSequences:n,aiSuggestions:o,learningProgress:a,modelMetrics:g,topPrediction:_,isAIReady:$,suggestionCount:L,predictNextAtom:S,generateSuggestions:T,executeAISuggestion:D,learnFromOperation:l,generatePresentation:s,executeOperationSequence:h,analyzeUserPatterns:j,getOperationSequences:x,clearSuggestions:u,clearPredictions:p,startAutoSuggestions:c,stopAutoSuggestions:M,suggestTemplate:z,enhanceContent:Z}}),Ve=Me(),Xe={id:"app",class:"app"},Ze=Q({__name:"App",setup(f){const e=he();ae(()=>{e.startAutoSuggestions(),document.addEventListener("keydown",n)}),re(()=>{e.stopAutoSuggestions(),document.removeEventListener("keydown",n)});function n(o){if(o.ctrlKey||o.metaKey)switch(o.key){case"s":o.preventDefault();break;case"z":o.shiftKey,o.preventDefault();break}}return(o,a)=>{const g=Pe("router-view");return y(),k("div",Xe,[le(g)])}}}),We={class:"toolbar-main"},Ge={class:"toolbar-section"},Je=["disabled"],Ke=["disabled"],Qe={class:"toolbar-section"},qe={key:0,class:"dropdown-menu"},et={class:"toolbar-section"},tt=["disabled"],nt={class:"toolbar-section"},ot={key:0,class:"dropdown-menu"},st=["onClick"],it=Q({__name:"ToolbarMain",setup(f){const e=K(),n=F(!1),o=F(!1),a=F(),g=F(),_=F([{name:"Default",colors:{primary:"#1976D2",secondary:"#424242",background:"#FFFFFF",text:"#333333",accent:"#FF5722"}},{name:"Dark",colors:{primary:"#BB86FC",secondary:"#03DAC6",background:"#121212",text:"#FFFFFF",accent:"#CF6679"}},{name:"Nature",colors:{primary:"#4CAF50",secondary:"#8BC34A",background:"#F1F8E9",text:"#2E7D32",accent:"#FF9800"}},{name:"Ocean",colors:{primary:"#2196F3",secondary:"#00BCD4",background:"#E3F2FD",text:"#0D47A1",accent:"#FF5722"}},{name:"Sunset",colors:{primary:"#FF5722",secondary:"#FF9800",background:"#FFF3E0",text:"#BF360C",accent:"#9C27B0"}}]);function $(){n.value=!n.value,o.value=!1}function L(){o.value=!o.value,n.value=!1}function S(){n.value=!1,o.value=!1}function T(){confirm("Create a new presentation? Unsaved changes will be lost.")&&e.newPresentation()}function D(){console.log("Open presentation")}async function l(){try{const c=e.exportPresentation();(await fetch(`/api/presentations/${c.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})).ok?console.log("✅ Presentation saved"):console.error("❌ Failed to save presentation")}catch(c){console.error("Save error:",c)}}async function s(){S();const c=e.canvas.activeSlide;await e.addText(c,{content:"Click to edit text",x:100,y:100,width:300,height:60,fontSize:18,color:"#333333"})}async function h(){S();const c=document.createElement("input");c.type="file",c.accept="image/*",c.onchange=async M=>{var Z;const z=(Z=M.target.files)==null?void 0:Z[0];if(z){const C=new FileReader;C.onload=async r=>{var B;const v=(B=r.target)==null?void 0:B.result,I=e.canvas.activeSlide;await e.addImage(I,{src:v,x:100,y:100,width:300,height:200})},C.readAsDataURL(z)}},c.click()}async function j(){S();const c=e.canvas.activeSlide;await e.addShape(c,{shape:"rectangle",x:100,y:100,width:150,height:100,fill:"#1976D2",stroke:"#1565C0",strokeWidth:2})}async function x(){S();const c=e.canvas.activeSlide;await e.addChart(c,{chartType:"bar",data:{labels:["Q1","Q2","Q3","Q4"],datasets:[{label:"Sales",data:[30,45,60,80],backgroundColor:"#1976D2"}]},x:100,y:100,width:400,height:250})}async function u(){S();const c=e.canvas.activeSlide;await e.addTable(c,{rows:3,columns:3,data:[["Header 1","Header 2","Header 3"],["Cell 1","Cell 2","Cell 3"],["Cell 4","Cell 5","Cell 6"]],x:100,y:100,width:400,height:200})}async function p(){await e.createSlide()}async function E(){confirm("Delete this slide?")&&await e.deleteSlide(e.canvas.activeSlide)}async function A(){const c=e.currentSlide;c&&await e.createSlide({layout:c.layout,elements:c.elements.map(M=>({...M}))})}async function J(c){S(),await e.applyTheme(c)}function b(c){return{background:`linear-gradient(45deg, ${c.colors.primary}, ${c.colors.secondary})`,width:"20px",height:"20px",borderRadius:"4px"}}function i(c){a.value&&!a.value.contains(c.target)&&(n.value=!1),g.value&&!g.value.contains(c.target)&&(o.value=!1)}return ae(()=>{document.addEventListener("click",i)}),re(()=>{document.removeEventListener("click",i)}),(c,M)=>(y(),k("div",We,[t("div",{class:"toolbar-section"},[t("button",{class:"btn btn-ghost btn-sm",onClick:T,title:"New"}," 📄 "),t("button",{class:"btn btn-ghost btn-sm",onClick:D,title:"Open"}," 📁 "),t("button",{class:"btn btn-ghost btn-sm",onClick:l,title:"Save"}," 💾 "),M[2]||(M[2]=t("div",{class:"toolbar-divider"},null,-1))]),t("div",Ge,[t("button",{class:"btn btn-ghost btn-sm",disabled:!O(e).canUndo,onClick:M[0]||(M[0]=z=>O(e).undo()),title:"Undo"}," ↶ ",8,Je),t("button",{class:"btn btn-ghost btn-sm",disabled:!O(e).canRedo,onClick:M[1]||(M[1]=z=>O(e).redo()),title:"Redo"}," ↷ ",8,Ke),M[3]||(M[3]=t("div",{class:"toolbar-divider"},null,-1))]),t("div",Qe,[t("div",{class:"dropdown",ref_key:"addDropdown",ref:a},[t("button",{class:"btn btn-ghost btn-sm dropdown-trigger",onClick:$,title:"Add Element"}," ➕ Add "),n.value?(y(),k("div",qe,[t("button",{class:"dropdown-item",onClick:s}," 📝 Text "),t("button",{class:"dropdown-item",onClick:h}," 🖼️ Image "),t("button",{class:"dropdown-item",onClick:j}," 🔷 Shape "),t("button",{class:"dropdown-item",onClick:x}," 📊 Chart "),t("button",{class:"dropdown-item",onClick:u}," 📋 Table ")])):Y("",!0)],512),M[4]||(M[4]=t("div",{class:"toolbar-divider"},null,-1))]),t("div",et,[t("button",{class:"btn btn-ghost btn-sm",onClick:p,title:"New Slide"}," 📄+ "),t("button",{class:"btn btn-ghost btn-sm",disabled:O(e).totalSlides<=1,onClick:E,title:"Delete Slide"}," 🗑️ ",8,tt),t("button",{class:"btn btn-ghost btn-sm",onClick:A,title:"Duplicate Slide"}," 📋 "),M[5]||(M[5]=t("div",{class:"toolbar-divider"},null,-1))]),t("div",nt,[t("div",{class:"dropdown",ref_key:"themeDropdown",ref:g},[t("button",{class:"btn btn-ghost btn-sm dropdown-trigger",onClick:L,title:"Themes"}," 🎨 Theme "),o.value?(y(),k("div",ot,[(y(!0),k(ee,null,oe(_.value,z=>(y(),k("button",{key:z.name,class:"dropdown-item theme-item",onClick:Z=>J(z)},[t("div",{class:"theme-preview",style:V(b(z))},null,4),te(" "+H(z.name),1)],8,st))),128))])):Y("",!0)],512)])]))}}),q=(f,e)=>{const n=f.__vccOpts||f;for(const[o,a]of e)n[o]=a;return n},lt=q(it,[["__scopeId","data-v-2ade5cd8"]]),at={class:"ai-panel"},rt={key:0,class:"suggestion-badge"},ct={key:0,class:"ai-panel-content"},dt={class:"ai-header"},ut={class:"ai-body"},pt={class:"ai-status"},mt={key:0},ft={key:1},vt={class:"quick-actions"},ht=["disabled"],yt=["disabled"],gt=["disabled"],bt={key:0,class:"suggestions"},wt={class:"suggestion-list"},kt={class:"suggestion-content"},xt={class:"suggestion-title"},St={class:"suggestion-description"},Et={class:"suggestion-actions"},Ct=["onClick"],$t=["onClick"],_t={class:"ai-metrics"},At={class:"metric"},It={class:"metric"},Tt={class:"metric"},Dt={class:"modal-header"},Mt={class:"modal-body"},Pt={class:"form-group"},Ft={class:"form-group"},Ot={class:"form-group"},Rt={class:"modal-footer"},zt=["disabled"],Lt=Q({__name:"AIPanel",setup(f){const e=he(),n=K(),o=F(!1),a=F(!1),g=F(""),_=F("business"),$=F(10);function L(){o.value=!o.value}async function S(){await e.generateSuggestions(n.canvas.activeSlide)}async function T(){n.currentSlide&&await e.generateSuggestions(n.canvas.activeSlide)}async function D(){if(g.value.trim())try{const x=`${g.value}

Type: ${_.value}
Slides: ${$.value}`,u=await e.generatePresentation(x);n.newPresentation(),await e.executeOperationSequence(u),a.value=!1,g.value=""}catch(x){console.error("Failed to generate presentation:",x),alert("Failed to generate presentation. Please try again.")}}async function l(x){try{await e.executeAISuggestion(x)}catch(u){console.error("Failed to apply suggestion:",u),alert("Failed to apply suggestion. Please try again.")}}function s(x){e.aiSuggestions.splice(x,1)}function h(x){const u={ADD:"Add",REMOVE:"Remove",MODIFY:"Modify",CREATE:"Create",DELETE:"Delete",REORDER:"Reorder",APPLY:"Apply"},p={text:"Text",image:"Image",shape:"Shape",chart:"Chart",table:"Table",slide:"Slide",theme:"Theme"};return`${u[x.op]} ${p[x.type]||x.type}`}function j(x){switch(x.op){case"ADD":return`Add a new ${x.type} element to enhance your slide`;case"MODIFY":return"Improve the styling and positioning of existing elements";case"CREATE":return"Create a new slide with optimized layout";case"APPLY":return`Apply ${x.type} to improve visual consistency`;default:return`Suggested ${x.op.toLowerCase()} operation`}}return(x,u)=>(y(),k("div",at,[t("button",{class:se(["ai-toggle-btn",{active:o.value}]),onClick:L,title:"AI Assistant"},[u[9]||(u[9]=te(" 🤖 AI ")),O(e).suggestionCount>0?(y(),k("span",rt,H(O(e).suggestionCount),1)):Y("",!0)],2),o.value?(y(),k("div",ct,[t("div",dt,[u[10]||(u[10]=t("h3",null,"AI Assistant",-1)),t("button",{class:"close-btn",onClick:u[0]||(u[0]=p=>o.value=!1)},"×")]),t("div",ut,[t("div",pt,[t("div",{class:se(["status-indicator",{ready:O(e).isAIReady}])},null,2),O(e).isAIReady?(y(),k("span",mt,"AI Ready")):(y(),k("span",ft,"Learning... ("+H(O(e).modelMetrics.totalOperations)+"/100 operations)",1))]),t("div",vt,[u[11]||(u[11]=t("h4",null,"Quick Actions",-1)),t("button",{class:"action-btn",onClick:S,disabled:O(e).isLearning}," 💡 Get Suggestions ",8,ht),t("button",{class:"action-btn",onClick:u[1]||(u[1]=p=>a.value=!0),disabled:!O(e).isAIReady}," ✨ Generate Presentation ",8,yt),t("button",{class:"action-btn",onClick:T,disabled:!O(e).isAIReady}," 🎨 Enhance Slide ",8,gt)]),O(e).suggestionCount>0?(y(),k("div",bt,[u[12]||(u[12]=t("h4",null,"Suggestions",-1)),t("div",wt,[(y(!0),k(ee,null,oe(O(e).aiSuggestions,(p,E)=>(y(),k("div",{key:E,class:"suggestion-item"},[t("div",kt,[t("div",xt,H(h(p)),1),t("div",St,H(j(p)),1)]),t("div",Et,[t("button",{class:"btn btn-sm btn-primary",onClick:A=>l(p)}," Apply ",8,Ct),t("button",{class:"btn btn-sm btn-ghost",onClick:A=>s(E)}," × ",8,$t)])]))),128))])])):Y("",!0),t("div",_t,[u[16]||(u[16]=t("h4",null,"AI Performance",-1)),t("div",At,[u[13]||(u[13]=t("span",null,"Accuracy:",-1)),t("span",null,H(Math.round(O(e).modelMetrics.accuracy*100))+"%",1)]),t("div",It,[u[14]||(u[14]=t("span",null,"Operations:",-1)),t("span",null,H(O(e).modelMetrics.totalOperations),1)]),t("div",Tt,[u[15]||(u[15]=t("span",null,"Successful Predictions:",-1)),t("span",null,H(O(e).modelMetrics.successfulPredictions),1)])])])])):Y("",!0),a.value?(y(),k("div",{key:1,class:"modal-overlay",onClick:u[8]||(u[8]=p=>a.value=!1)},[t("div",{class:"modal-content",onClick:u[7]||(u[7]=fe(()=>{},["stop"]))},[t("div",Dt,[u[17]||(u[17]=t("h3",null,"Generate Presentation",-1)),t("button",{class:"close-btn",onClick:u[2]||(u[2]=p=>a.value=!1)},"×")]),t("div",Mt,[t("div",Pt,[u[18]||(u[18]=t("label",null,"Describe your presentation:",-1)),de(t("textarea",{"onUpdate:modelValue":u[3]||(u[3]=p=>g.value=p),placeholder:"e.g., A quarterly business review with sales data, market analysis, and future projections",rows:"4"},null,512),[[ve,g.value]])]),t("div",Ft,[u[20]||(u[20]=t("label",null,"Presentation type:",-1)),de(t("select",{"onUpdate:modelValue":u[4]||(u[4]=p=>_.value=p)},u[19]||(u[19]=[Ee('<option value="business" data-v-d01b2e69>Business</option><option value="educational" data-v-d01b2e69>Educational</option><option value="marketing" data-v-d01b2e69>Marketing</option><option value="technical" data-v-d01b2e69>Technical</option><option value="creative" data-v-d01b2e69>Creative</option>',5)]),512),[[Fe,_.value]])]),t("div",Ot,[u[21]||(u[21]=t("label",null,"Number of slides:",-1)),de(t("input",{type:"number","onUpdate:modelValue":u[5]||(u[5]=p=>$.value=p),min:"3",max:"20",placeholder:"10"},null,512),[[ve,$.value]])])]),t("div",Rt,[t("button",{class:"btn btn-ghost",onClick:u[6]||(u[6]=p=>a.value=!1)}," Cancel "),t("button",{class:"btn btn-primary",onClick:D,disabled:!g.value.trim()||O(e).isLearning},H(O(e).isLearning?"Generating...":"Generate"),9,zt)])])])):Y("",!0)]))}}),Bt=q(Lt,[["__scopeId","data-v-d01b2e69"]]),Nt={class:"slide-thumbnails"},Ht={class:"thumbnails-list"},Yt=["onClick","onContextmenu"],Ut={class:"thumbnail-preview"},jt={class:"slide-number"},Vt={class:"slide-content"},Xt={key:0,class:"mini-text"},Zt={key:1,class:"mini-image"},Wt={key:2,class:"mini-shape"},Gt={key:3,class:"mini-chart"},Jt={key:4,class:"mini-table"},Kt={class:"thumbnail-info"},Qt={class:"slide-title"},qt={class:"element-count"},en=Q({__name:"SlideThumbnails",setup(f){const e=K(),n=F({visible:!1,x:0,y:0,slideIndex:-1}),o=P(()=>({position:"fixed",left:`${n.value.x}px`,top:`${n.value.y}px`,zIndex:1e3}));function a(x){e.setActiveSlide(x)}async function g(){await e.createSlide()}function _(x,u){x.preventDefault(),n.value={visible:!0,x:x.clientX,y:x.clientY,slideIndex:u}}function $(){n.value.visible=!1}async function L(){const x=n.value.slideIndex,u=e.presentation.slides[x];u&&await e.createSlide({layout:u.layout,elements:u.elements.map(p=>({...p}))}),$()}async function S(){const x=n.value.slideIndex;e.presentation.slides.length>1&&confirm("Delete this slide?")&&await e.deleteSlide(x),$()}async function T(){const x=n.value.slideIndex;if(x>0){const u=[...e.presentation.slides],p=u.splice(x,1)[0];u.splice(x-1,0,p);const E=u.map((A,J)=>J);await e.reorderSlides(E),e.setActiveSlide(x-1)}$()}async function D(){const x=n.value.slideIndex,u=e.presentation.slides.length;if(x<u-1){const p=[...e.presentation.slides],E=p.splice(x,1)[0];p.splice(x+1,0,E);const A=p.map((J,b)=>b);await e.reorderSlides(A),e.setActiveSlide(x+1)}$()}function l(x){const E=160/e.presentation.settings.width,A=90/e.presentation.settings.height;return{position:"absolute",left:`${x.left*E}px`,top:`${x.top*A}px`,width:`${x.width*E}px`,height:`${x.height*A}px`,transform:`rotate(${x.rotate}deg)`}}function s(x){if(x.type!=="text")return"";const u=x.content.replace(/<[^>]*>/g,""),p=u.split(" ").slice(0,3);return p.join(" ")+(p.length<u.split(" ").length?"...":"")}function h(x){const u=x.elements.find(E=>E.type==="text"&&E.style==="heading");if(u)return s(u);const p=x.elements.find(E=>E.type==="text");return p?s(p):""}function j(x){n.value.visible&&$()}return ae(()=>{document.addEventListener("click",j)}),re(()=>{document.removeEventListener("click",j)}),(x,u)=>(y(),k("div",Nt,[t("div",{class:"thumbnails-header"},[u[1]||(u[1]=t("h3",null,"Slides",-1)),t("button",{class:"btn btn-sm btn-primary",onClick:g}," + Add ")]),t("div",Ht,[(y(!0),k(ee,null,oe(O(e).presentation.slides,(p,E)=>(y(),k("div",{key:p.id,class:se(["thumbnail-item",{active:E===O(e).canvas.activeSlide}]),onClick:A=>a(E),onContextmenu:A=>_(A,E)},[t("div",Ut,[t("div",jt,H(E+1),1),t("div",Vt,[(y(!0),k(ee,null,oe(p.elements,A=>(y(),k("div",{key:A.id,class:se(`mini-element mini-${A.type}`),style:V(l(A))},[A.type==="text"?(y(),k("span",Xt,H(s(A)),1)):A.type==="image"?(y(),k("div",Zt,"🖼️")):A.type==="shape"?(y(),k("div",Wt,"🔷")):A.type==="chart"?(y(),k("div",Gt,"📊")):A.type==="table"?(y(),k("div",Jt,"📋")):Y("",!0)],6))),128))])]),t("div",Kt,[t("div",Qt,H(h(p)||`Slide ${E+1}`),1),t("div",qt,H(p.elements.length)+" elements ",1)])],42,Yt))),128))]),n.value.visible?(y(),k("div",{key:0,class:"context-menu",style:V(o.value),onClick:u[0]||(u[0]=fe(()=>{},["stop"]))},[t("button",{class:"context-item",onClick:L}," 📋 Duplicate "),t("button",{class:"context-item",onClick:S}," 🗑️ Delete "),u[2]||(u[2]=t("div",{class:"context-separator"},null,-1)),t("button",{class:"context-item",onClick:T}," ⬆️ Move Up "),t("button",{class:"context-item",onClick:D}," ⬇️ Move Down ")],4)):Y("",!0)]))}}),tn=q(en,[["__scopeId","data-v-42c97890"]]),nn=["contenteditable","innerHTML"],on=["src"],sn=["viewBox"],ln=["d","fill","stroke","stroke-width"],an=["onDblclick"],rn=["src","poster","autoplay","loop","controls"],cn=["src","autoplay","loop"],dn={key:7,class:"selection-handles"},un=["onMousedown"],pn=Q({__name:"ElementRenderer",props:{element:{},selected:{type:Boolean},zoom:{}},emits:["select","update","delete"],setup(f,{emit:e}){Ce.register(...Be);const n=f,o=e,a=F(!1),g=F(!1),_=F(!1),$=F(!1),L=F({x:0,y:0,elementX:0,elementY:0}),S=F({x:0,y:0,width:0,height:0,handle:""}),T=F({x:0,y:0,rotation:0}),D=F(),l=F(null),s=P(()=>({position:"absolute",left:`${n.element.left}px`,top:`${n.element.top}px`,width:`${n.element.width}px`,height:`${n.element.height}px`,transform:`rotate(${n.element.rotate}deg)`,zIndex:n.element.zIndex||1,opacity:n.element.opacity||1,cursor:a.value?"grabbing":"grab"})),h=P(()=>{if(n.element.type!=="text")return{};const d=n.element;return{fontFamily:d.fontFamily||d.defaultFontName,fontSize:`${d.fontSize||16}px`,color:d.color||d.defaultColor,fontWeight:d.bold?"bold":"normal",fontStyle:d.italic?"italic":"normal",textDecoration:d.underline?"underline":"none",textAlign:d.align||"left",lineHeight:d.lineHeight||1.5,padding:"8px",outline:"none",width:"100%",height:"100%",display:"flex",alignItems:"center",backgroundColor:d.fill||"transparent"}}),j=P(()=>{if(n.element.type!=="image")return{};const d=n.element;return{width:"100%",height:"100%",objectFit:d.fit||"contain",borderRadius:d.borderRadius?`${d.borderRadius}px`:"0",filter:d.filter||"none",transform:`scaleX(${d.flipH?-1:1}) scaleY(${d.flipV?-1:1})`,boxShadow:d.shadow?"0 4px 8px rgba(0,0,0,0.2)":"none"}}),x=P(()=>({width:"100%",height:"100%"})),u=P(()=>`0 0 ${n.element.width} ${n.element.height}`),p=P(()=>{if(n.element.type!=="shape")return"";switch(n.element.shape){case"rectangle":return`M 0 0 L ${n.element.width} 0 L ${n.element.width} ${n.element.height} L 0 ${n.element.height} Z`;case"circle":const N=n.element.width/2,m=n.element.height/2,w=Math.min(N,m);return`M ${N} ${m} m -${w} 0 a ${w} ${w} 0 1 0 ${w*2} 0 a ${w} ${w} 0 1 0 -${w*2} 0`;case"triangle":return`M ${n.element.width/2} 0 L ${n.element.width} ${n.element.height} L 0 ${n.element.height} Z`;default:return`M 0 0 L ${n.element.width} 0 L ${n.element.width} ${n.element.height} L 0 ${n.element.height} Z`}}),E=P(()=>{var N,m;if(n.element.type!=="table")return{};const d=n.element;return{width:"100%",height:"100%",borderCollapse:"collapse",border:`${((N=d.style)==null?void 0:N.borderWidth)||1}px solid ${((m=d.style)==null?void 0:m.borderColor)||"#ddd"}`}}),A=P(()=>({width:"100%",height:"100%",objectFit:"contain"})),J=P(()=>({width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"8px"})),b=P(()=>[{position:"nw",style:{top:"-4px",left:"-4px"}},{position:"n",style:{top:"-4px",left:"50%",transform:"translateX(-50%)"}},{position:"ne",style:{top:"-4px",right:"-4px"}},{position:"e",style:{top:"50%",right:"-4px",transform:"translateY(-50%)"}},{position:"se",style:{bottom:"-4px",right:"-4px"}},{position:"s",style:{bottom:"-4px",left:"50%",transform:"translateX(-50%)"}},{position:"sw",style:{bottom:"-4px",left:"-4px"}},{position:"w",style:{top:"50%",left:"-4px",transform:"translateY(-50%)"}}]);function i(d){d.stopPropagation(),o("select",n.element.id,d.ctrlKey||d.metaKey)}function c(d){d.stopPropagation(),n.element.type==="text"&&($.value=!0,we(()=>{d.target.focus()}))}function M(d){$.value||(d.preventDefault(),d.stopPropagation(),a.value=!0,L.value={x:d.clientX,y:d.clientY,elementX:n.element.left,elementY:n.element.top},document.addEventListener("mousemove",z),document.addEventListener("mouseup",Z))}function z(d){if(!(!a.value&&!g.value&&!_.value))if(a.value){const N=(d.clientX-L.value.x)/n.zoom,m=(d.clientY-L.value.y)/n.zoom;o("update",n.element.id,{left:L.value.elementX+N,top:L.value.elementY+m})}else g.value?r(d):_.value&&I(d)}function Z(){a.value=!1,g.value=!1,_.value=!1,document.removeEventListener("mousemove",z),document.removeEventListener("mouseup",Z)}function C(d,N){d.stopPropagation(),g.value=!0,S.value={x:d.clientX,y:d.clientY,width:n.element.width,height:n.element.height,handle:N},document.addEventListener("mousemove",z),document.addEventListener("mouseup",Z)}function r(d){const N=(d.clientX-S.value.x)/n.zoom,m=(d.clientY-S.value.y)/n.zoom,w=S.value.handle;let R=S.value.width,X=S.value.height,ie=n.element.left,pe=n.element.top;w.includes("e")&&(R+=N),w.includes("w")&&(R-=N,ie+=N),w.includes("s")&&(X+=m),w.includes("n")&&(X-=m,pe+=m),R=Math.max(20,R),X=Math.max(20,X),o("update",n.element.id,{width:R,height:X,left:ie,top:pe})}function v(d){d.stopPropagation(),_.value=!0,T.value={x:d.clientX,y:d.clientY,rotation:n.element.rotate},document.addEventListener("mousemove",z),document.addEventListener("mouseup",Z)}function I(d){const N=n.element.left+n.element.width/2,m=n.element.top+n.element.height/2,w=Math.atan2(T.value.y-m,T.value.x-N),X=(Math.atan2(d.clientY-m,d.clientX-N)-w)*(180/Math.PI),ie=T.value.rotation+X;o("update",n.element.id,{rotate:ie%360})}function B(){$.value=!1}function U(d){const N=d.target;o("update",n.element.id,{content:N.innerHTML})}function G(){}function ue(){console.error("Failed to load image:",n.element.id)}function ce(d,N){var R,X,ie,pe;if(n.element.type!=="table")return{};const m=n.element,w=d===0;return{padding:`${((R=m.style)==null?void 0:R.cellPadding)||8}px`,border:`1px solid ${((X=m.style)==null?void 0:X.borderColor)||"#ddd"}`,backgroundColor:w?((ie=m.style)==null?void 0:ie.headerBg)||"#f5f5f5":"transparent",color:w&&((pe=m.style)==null?void 0:pe.headerColor)||"#333",fontWeight:w?"bold":"normal"}}function xe(d,N){console.log("Edit cell:",d,N)}function ye(){if(n.element.type!=="chart"||!D.value)return;const d=n.element,N=D.value.getContext("2d");l.value&&l.value.destroy(),l.value=new Ce(N,{type:d.chartType,data:d.data,options:{responsive:!0,maintainAspectRatio:!1,...d.options}})}return Oe(()=>n.element,()=>{n.element.type==="chart"&&we(()=>{ye()})},{deep:!0}),ae(()=>{n.element.type==="chart"&&we(()=>{ye()})}),re(()=>{l.value&&l.value.destroy()}),(d,N)=>(y(),k("div",{class:se(["element-renderer",{selected:d.selected,dragging:a.value,[`element-${d.element.type}`]:!0}]),style:V(s.value),onMousedown:M,onClick:i,onDblclick:c},[d.element.type==="text"?(y(),k("div",{key:0,class:"text-element",style:V(h.value),contenteditable:$.value,onBlur:B,onInput:U,innerHTML:d.element.content},null,44,nn)):d.element.type==="image"?(y(),k("img",{key:1,class:"image-element",src:d.element.src,style:V(j.value),onLoad:G,onError:ue},null,44,on)):d.element.type==="shape"?(y(),k("svg",{key:2,class:"shape-element",style:V(x.value),viewBox:u.value},[t("path",{d:p.value,fill:d.element.fill,stroke:d.element.stroke,"stroke-width":d.element.strokeWidth},null,8,ln)],12,sn)):d.element.type==="chart"?(y(),k("div",{key:3,class:"chart-element",ref_key:"chartContainer",ref:D},null,512)):d.element.type==="table"?(y(),k("table",{key:4,class:"table-element",style:V(E.value)},[(y(!0),k(ee,null,oe(d.element.data,(m,w)=>(y(),k("tr",{key:w},[(y(!0),k(ee,null,oe(m,(R,X)=>(y(),k("td",{key:X,style:V(ce(w)),onDblclick:ie=>xe(w,X)},H(R),45,an))),128))]))),128))],4)):d.element.type==="video"?(y(),k("video",{key:5,class:"video-element",src:d.element.src,poster:d.element.poster,autoplay:d.element.autoplay,loop:d.element.loop,controls:d.element.controls,style:V(A.value)},null,12,rn)):d.element.type==="audio"?(y(),k("div",{key:6,class:"audio-element",style:V(J.value)},[t("div",{class:"audio-icon",style:V({color:d.element.iconColor})},"🔊",4),t("audio",{src:d.element.src,autoplay:d.element.autoplay,loop:d.element.loop,controls:""},null,8,cn)],4)):Y("",!0),d.selected&&!$.value?(y(),k("div",dn,[(y(!0),k(ee,null,oe(b.value,m=>(y(),k("div",{key:m.position,class:se(`handle handle-${m.position}`),style:V(m.style),onMousedown:w=>C(w,m.position)},null,46,un))),128))])):Y("",!0),d.selected&&!$.value?(y(),k("div",{key:8,class:"rotation-handle",onMousedown:v},N[0]||(N[0]=[t("div",{class:"rotation-icon"},"↻",-1)]),32)):Y("",!0)],38))}}),mn=q(pn,[["__scopeId","data-v-71487d86"]]),fn=Q({__name:"SelectionBox",props:{box:{}},setup(f){const e=f,n=P(()=>({position:"absolute",left:`${Math.min(e.box.x,e.box.x+e.box.width)}px`,top:`${Math.min(e.box.y,e.box.y+e.box.height)}px`,width:`${Math.abs(e.box.width)}px`,height:`${Math.abs(e.box.height)}px`,border:"1px dashed var(--primary)",backgroundColor:"rgba(25, 118, 210, 0.1)",pointerEvents:"none",zIndex:1e3}));return(o,a)=>(y(),k("div",{class:"selection-box",style:V(n.value)},null,4))}}),vn=q(fn,[["__scopeId","data-v-b6ef8827"]]),hn=["onClick"],yn={class:"menu-icon"},gn={class:"menu-label"},bn=Q({__name:"ContextMenu",props:{x:{},y:{},items:{}},emits:["select","close"],setup(f,{emit:e}){const n=f,o=e,a=P(()=>({position:"fixed",left:`${n.x}px`,top:`${n.y}px`,zIndex:2e3}));function g($){$.type==="separator"||$.disabled||($.action&&o("select",$.action),o("close"))}function _($){o("close")}return ae(()=>{document.addEventListener("click",_),document.addEventListener("contextmenu",_)}),re(()=>{document.removeEventListener("click",_),document.removeEventListener("contextmenu",_)}),($,L)=>(y(),k("div",{class:"context-menu",style:V(a.value),onClick:L[0]||(L[0]=fe(()=>{},["stop"]))},[(y(!0),k(ee,null,oe($.items,(S,T)=>(y(),k("div",{key:T,class:se(["menu-item",{separator:S.type==="separator",disabled:S.disabled}]),onClick:D=>g(S)},[S.type!=="separator"?(y(),k(ee,{key:0},[t("span",yn,H(S.icon),1),t("span",gn,H(S.label),1)],64)):Y("",!0)],10,hn))),128))],4))}}),wn=q(bn,[["__scopeId","data-v-ff0fc2d6"]]),kn={class:"toolbar-content"},xn=Q({__name:"ElementToolbar",props:{elements:{},position:{}},setup(f){const e=f,n=K(),o=P(()=>({position:"absolute",left:`${e.position.x}px`,top:`${e.position.y}px`,transform:"translateX(-50%)",zIndex:1e3})),a=P(()=>e.elements.some(p=>p.type==="text")),g=P(()=>e.elements.filter(p=>p.type==="text").every(p=>p.bold)),_=P(()=>e.elements.filter(p=>p.type==="text").every(p=>p.italic)),$=P(()=>e.elements.filter(p=>p.type==="text").every(p=>p.underline));async function L(){const p=e.elements.filter(A=>A.type==="text"),E=!g.value;for(const A of p)await n.modifyElement(A.id,{bold:E})}async function S(){const p=e.elements.filter(A=>A.type==="text"),E=!_.value;for(const A of p)await n.modifyElement(A.id,{italic:E})}async function T(){const p=e.elements.filter(A=>A.type==="text"),E=!$.value;for(const A of p)await n.modifyElement(A.id,{underline:E})}async function D(){for(const p of e.elements)p.type==="text"&&await n.modifyElement(p.id,{align:"left"})}async function l(){for(const p of e.elements)p.type==="text"&&await n.modifyElement(p.id,{align:"center"})}async function s(){for(const p of e.elements)p.type==="text"&&await n.modifyElement(p.id,{align:"right"})}async function h(){const p=Math.max(...n.currentSlide.elements.map(E=>E.zIndex||1));for(const E of e.elements)await n.modifyElement(E.id,{zIndex:p+1})}async function j(){const p=Math.min(...n.currentSlide.elements.map(E=>E.zIndex||1));for(const E of e.elements)await n.modifyElement(E.id,{zIndex:Math.max(0,p-1)})}async function x(){n.copyElements(e.elements.map(p=>p.id)),await n.pasteElements()}async function u(){for(const p of e.elements)await n.removeElement(p.id);n.clearSelection()}return(p,E)=>(y(),k("div",{class:"element-toolbar",style:V(o.value)},[t("div",kn,[t("button",{class:"tool-btn",onClick:h,title:"Bring to Front"}," ⬆️ "),t("button",{class:"tool-btn",onClick:j,title:"Send to Back"}," ⬇️ "),E[4]||(E[4]=t("div",{class:"toolbar-separator"},null,-1)),a.value?(y(),k(ee,{key:0},[t("button",{class:se(["tool-btn",{active:g.value}]),onClick:L,title:"Bold"},E[0]||(E[0]=[t("strong",null,"B",-1)]),2),t("button",{class:se(["tool-btn",{active:_.value}]),onClick:S,title:"Italic"},E[1]||(E[1]=[t("em",null,"I",-1)]),2),t("button",{class:se(["tool-btn",{active:$.value}]),onClick:T,title:"Underline"},E[2]||(E[2]=[t("u",null,"U",-1)]),2),E[3]||(E[3]=t("div",{class:"toolbar-separator"},null,-1))],64)):Y("",!0),t("button",{class:"tool-btn",onClick:D,title:"Align Left"}," ⬅️ "),t("button",{class:"tool-btn",onClick:l,title:"Align Center"}," ↔️ "),t("button",{class:"tool-btn",onClick:s,title:"Align Right"}," ➡️ "),E[5]||(E[5]=t("div",{class:"toolbar-separator"},null,-1)),t("button",{class:"tool-btn",onClick:x,title:"Duplicate"}," 📋 "),t("button",{class:"tool-btn danger",onClick:u,title:"Delete"}," 🗑️ ")])],4))}}),Sn=q(xn,[["__scopeId","data-v-0346b199"]]),En={key:0,class:"canvas-grid"},Cn=Q({__name:"CanvasEditor",setup(f){const e=K(),n=he(),o=F();F(!1),F({x:0,y:0});const a=F({visible:!1,x:0,y:0,width:0,height:0}),g=F({visible:!1,x:0,y:0}),_=P(()=>{var r;return((r=e.currentSlide)==null?void 0:r.elements)||[]}),$=P(()=>_.value.filter(r=>e.selectedElements.includes(r.id))),L=P(()=>({transform:`scale(${e.canvas.zoom})`,transformOrigin:"center center"})),S=P(()=>{const r=e.presentation.settings;return{width:`${r.width}px`,height:`${r.height}px`,transform:`translate(${e.canvas.offsetX}px, ${e.canvas.offsetY}px)`}}),T=P(()=>{var v,I,B,U,G;const r=(v=e.currentSlide)==null?void 0:v.background;if(!r)return{backgroundColor:"#ffffff"};switch(r.type){case"solid":return{backgroundColor:r.color};case"gradient":if(((I=r.gradient)==null?void 0:I.type)==="linear"){const ue=r.gradient.colors.map(ce=>`${ce.color} ${ce.pos}%`).join(", ");return{background:`linear-gradient(${r.gradient.rotate||0}deg, ${ue})`}}break;case"image":return{backgroundImage:`url(${(B=r.image)==null?void 0:B.src})`,backgroundSize:((U=r.image)==null?void 0:U.size)||"cover",backgroundPosition:((G=r.image)==null?void 0:G.position)||"center"}}return{backgroundColor:"#ffffff"}}),D=P(()=>[{label:"Add Text",action:"add-text",icon:"📝"},{label:"Add Image",action:"add-image",icon:"🖼️"},{label:"Add Shape",action:"add-shape",icon:"🔷"},{label:"Add Chart",action:"add-chart",icon:"📊"},{label:"Add Table",action:"add-table",icon:"📋"},{type:"separator"},{label:"Paste",action:"paste",icon:"📋",disabled:e.clipboard.length===0},{type:"separator"},{label:"AI Suggestions",action:"ai-suggestions",icon:"🤖"}]),l=P(()=>{if($.value.length===0)return{x:0,y:0};const r=z($.value);return{x:r.x+r.width/2,y:r.y-50}});function s(r){r.target===r.currentTarget&&(e.clearSelection(),j())}function h(r){r.preventDefault();const v=o.value.getBoundingClientRect();g.value={visible:!0,x:r.clientX-v.left,y:r.clientY-v.top}}function j(){g.value.visible=!1}async function x(r){j();const v=o.value.getBoundingClientRect(),I=o.value.querySelector(".slide-content").getBoundingClientRect(),B=(g.value.x-(I.left-v.left))/e.canvas.zoom,U=(g.value.y-(I.top-v.top))/e.canvas.zoom;switch(r){case"add-text":await J(B,U);break;case"add-image":await b(B,U);break;case"add-shape":await i(B,U);break;case"add-chart":await c(B,U);break;case"add-table":await M(B,U);break;case"paste":await e.pasteElements();break;case"ai-suggestions":await n.generateSuggestions(e.canvas.activeSlide);break}}function u(r,v=!1){v?e.toggleElementSelection(r):e.selectElements([r])}function p(r){return e.selectedElements.includes(r)}async function E(r,v){await e.modifyElement(r,v)}async function A(r){await e.removeElement(r),e.clearSelection()}async function J(r,v){await e.addText(e.canvas.activeSlide,{content:"Click to edit text",x:r-100,y:v-25,width:200,height:50,fontSize:16,color:"#333333"})}async function b(r,v){await e.addImage(e.canvas.activeSlide,{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgZmlsbD0iI2Y1ZjVmNSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiM5OTkiPkltYWdlIFBsYWNlaG9sZGVyPC90ZXh0Pjwvc3ZnPg==",x:r-100,y:v-75,width:200,height:150})}async function i(r,v){await e.addShape(e.canvas.activeSlide,{shape:"rectangle",x:r-50,y:v-25,width:100,height:50,fill:"#1976D2",stroke:"#1565C0",strokeWidth:2})}async function c(r,v){await e.addChart(e.canvas.activeSlide,{chartType:"bar",data:{labels:["Q1","Q2","Q3","Q4"],datasets:[{label:"Revenue",data:[30,45,60,80],backgroundColor:"#1976D2"}]},x:r-150,y:v-100,width:300,height:200})}async function M(r,v){await e.addTable(e.canvas.activeSlide,{rows:3,columns:3,data:[["Header 1","Header 2","Header 3"],["Row 1 Col 1","Row 1 Col 2","Row 1 Col 3"],["Row 2 Col 1","Row 2 Col 2","Row 2 Col 3"]],x:r-150,y:v-75,width:300,height:150})}function z(r){if(r.length===0)return{x:0,y:0,width:0,height:0};let v=1/0,I=1/0,B=-1/0,U=-1/0;for(const G of r)v=Math.min(v,G.left),I=Math.min(I,G.top),B=Math.max(B,G.left+G.width),U=Math.max(U,G.top+G.height);return{x:v,y:I,width:B-v,height:U-I}}function Z(r){if(r.target===document.body)switch(r.key){case"Delete":case"Backspace":e.selectedElements.length>0&&(r.preventDefault(),e.selectedElements.forEach(v=>{A(v)}));break}}ae(()=>{document.addEventListener("keydown",Z),we(()=>{C()})}),re(()=>{document.removeEventListener("keydown",Z)});function C(){if(!o.value)return;const v=o.value.getBoundingClientRect(),I=e.presentation.settings,B=(v.width-I.width*e.canvas.zoom)/2,U=(v.height-I.height*e.canvas.zoom)/2;e.setCanvasOffset(B,U)}return(r,v)=>(y(),k("div",{class:"canvas-editor",ref_key:"canvasContainer",ref:o},[t("div",{class:"canvas-background",style:V(L.value),onClick:s,onContextmenu:h},[O(e).canvas.gridVisible?(y(),k("div",En)):Y("",!0),t("div",{class:"slide-content",style:V(S.value)},[t("div",{class:"slide-background",style:V(T.value)},null,4),(y(!0),k(ee,null,oe(_.value,I=>(y(),me(mn,{key:I.id,element:I,selected:p(I.id),zoom:O(e).canvas.zoom,onSelect:u,onUpdate:E,onDelete:A},null,8,["element","selected","zoom"]))),128)),a.value.visible?(y(),me(vn,{key:0,box:a.value},null,8,["box"])):Y("",!0)],4)],36),g.value.visible?(y(),me(wn,{key:0,x:g.value.x,y:g.value.y,items:D.value,onSelect:x,onClose:j},null,8,["x","y","items"])):Y("",!0),$.value.length>0?(y(),me(Sn,{key:1,elements:$.value,position:l.value},null,8,["elements","position"])):Y("",!0)],512))}}),$n=q(Cn,[["__scopeId","data-v-cf51c8a0"]]),_n={class:"element-properties"},An={class:"property-section"},In={class:"property-group"},Tn={class:"input-row"},Dn={class:"input-group"},Mn=["value"],Pn={class:"input-group"},Fn=["value"],On={class:"input-row"},Rn={class:"input-group"},zn=["value"],Ln={class:"input-group"},Bn=["value"],Nn={class:"input-row"},Hn={class:"input-group"},Yn=["value"],Un={class:"input-group"},jn=["value"],Vn={key:0,class:"property-group"},Xn=["value"],Zn={class:"input-row"},Wn={class:"input-group"},Gn=["value"],Jn={class:"input-group"},Kn=["value"],Qn={class:"input-row"},qn={class:"input-group"},eo=["value"],to={class:"input-group"},no=["value"],oo={class:"checkbox-row"},so={class:"checkbox-label"},io=["checked"],lo={class:"checkbox-label"},ao=["checked"],ro={class:"checkbox-label"},co=["checked"],uo={key:1,class:"property-group"},po={class:"input-row"},mo={class:"input-group"},fo=["value"],vo={class:"input-group"},ho=["value"],yo={class:"checkbox-row"},go={class:"checkbox-label"},bo=["checked"],wo={class:"checkbox-label"},ko=["checked"],xo={class:"checkbox-label"},So=["checked"],Eo={key:2,class:"property-group"},Co={class:"input-row"},$o={class:"input-group"},_o=["value"],Ao={class:"input-group"},Io=["value"],To={class:"input-row"},Do={class:"input-group"},Mo=["value"],Po={key:3,class:"property-group"},Fo={class:"input-row"},Oo={class:"input-group"},Ro=["value"],zo=Q({__name:"ElementProperties",props:{element:{}},setup(f){const e=f,n=K();async function o(l,s){await n.modifyElement(e.element.id,{[l]:s})}function a(l){return{text:"Text",image:"Image",shape:"Shape",chart:"Chart",table:"Table",video:"Video",audio:"Audio"}[l]||l}function g(l){return l.type!=="text"?"":l.content.replace(/<[^>]*>/g,"")}async function _(){const l=n.currentSlide;if(!l)return;const s=Math.max(...l.elements.map(h=>h.zIndex||1));await o("zIndex",s+1)}async function $(){const l=n.currentSlide;if(!l)return;const s=Math.min(...l.elements.map(h=>h.zIndex||1));await o("zIndex",Math.max(0,s-1))}async function L(){const l=e.element.zIndex||1;await o("zIndex",l+1)}async function S(){const l=e.element.zIndex||1;await o("zIndex",Math.max(0,l-1))}async function T(){n.copyElements([e.element.id]),await n.pasteElements()}async function D(){confirm("Delete this element?")&&(await n.removeElement(e.element.id),n.clearSelection())}return(l,s)=>(y(),k("div",_n,[t("div",An,[t("h4",null,H(a(l.element.type)),1),t("div",In,[s[29]||(s[29]=t("label",null,"Position & Size",-1)),t("div",Tn,[t("div",Dn,[s[23]||(s[23]=t("label",null,"X",-1)),t("input",{type:"number",value:Math.round(l.element.left),onInput:s[0]||(s[0]=h=>o("left",Number(h.target.value)))},null,40,Mn)]),t("div",Pn,[s[24]||(s[24]=t("label",null,"Y",-1)),t("input",{type:"number",value:Math.round(l.element.top),onInput:s[1]||(s[1]=h=>o("top",Number(h.target.value)))},null,40,Fn)])]),t("div",On,[t("div",Rn,[s[25]||(s[25]=t("label",null,"Width",-1)),t("input",{type:"number",value:Math.round(l.element.width),onInput:s[2]||(s[2]=h=>o("width",Number(h.target.value)))},null,40,zn)]),t("div",Ln,[s[26]||(s[26]=t("label",null,"Height",-1)),t("input",{type:"number",value:Math.round(l.element.height),onInput:s[3]||(s[3]=h=>o("height",Number(h.target.value)))},null,40,Bn)])]),t("div",Nn,[t("div",Hn,[s[27]||(s[27]=t("label",null,"Rotation",-1)),t("input",{type:"number",value:Math.round(l.element.rotate),onInput:s[4]||(s[4]=h=>o("rotate",Number(h.target.value))),min:"0",max:"360"},null,40,Yn)]),t("div",Un,[s[28]||(s[28]=t("label",null,"Opacity",-1)),t("input",{type:"range",value:(l.element.opacity||1)*100,onInput:s[5]||(s[5]=h=>o("opacity",Number(h.target.value)/100)),min:"0",max:"100"},null,40,jn)])])]),l.element.type==="text"?(y(),k("div",Vn,[s[39]||(s[39]=t("label",null,"Text",-1)),t("textarea",{value:g(l.element),onInput:s[6]||(s[6]=h=>o("content",h.target.value)),rows:"3"},null,40,Xn),t("div",Zn,[t("div",Wn,[s[30]||(s[30]=t("label",null,"Font Size",-1)),t("input",{type:"number",value:l.element.fontSize||16,onInput:s[7]||(s[7]=h=>o("fontSize",Number(h.target.value))),min:"8",max:"72"},null,40,Gn)]),t("div",Jn,[s[32]||(s[32]=t("label",null,"Font Family",-1)),t("select",{value:l.element.fontFamily||"Arial",onChange:s[8]||(s[8]=h=>o("fontFamily",h.target.value))},s[31]||(s[31]=[Ee('<option value="Arial" data-v-a5199387>Arial</option><option value="Helvetica" data-v-a5199387>Helvetica</option><option value="Times New Roman" data-v-a5199387>Times New Roman</option><option value="Georgia" data-v-a5199387>Georgia</option><option value="Verdana" data-v-a5199387>Verdana</option>',5)]),40,Kn)])]),t("div",Qn,[t("div",qn,[s[33]||(s[33]=t("label",null,"Color",-1)),t("input",{type:"color",value:l.element.color||l.element.defaultColor,onInput:s[9]||(s[9]=h=>o("color",h.target.value))},null,40,eo)]),t("div",to,[s[35]||(s[35]=t("label",null,"Align",-1)),t("select",{value:l.element.align||"left",onChange:s[10]||(s[10]=h=>o("align",h.target.value))},s[34]||(s[34]=[t("option",{value:"left"},"Left",-1),t("option",{value:"center"},"Center",-1),t("option",{value:"right"},"Right",-1)]),40,no)])]),t("div",oo,[t("label",so,[t("input",{type:"checkbox",checked:l.element.bold||!1,onChange:s[11]||(s[11]=h=>o("bold",h.target.checked))},null,40,io),s[36]||(s[36]=te(" Bold "))]),t("label",lo,[t("input",{type:"checkbox",checked:l.element.italic||!1,onChange:s[12]||(s[12]=h=>o("italic",h.target.checked))},null,40,ao),s[37]||(s[37]=te(" Italic "))]),t("label",ro,[t("input",{type:"checkbox",checked:l.element.underline||!1,onChange:s[13]||(s[13]=h=>o("underline",h.target.checked))},null,40,co),s[38]||(s[38]=te(" Underline "))])])])):Y("",!0),l.element.type==="image"?(y(),k("div",uo,[s[46]||(s[46]=t("label",null,"Image",-1)),t("div",po,[t("div",mo,[s[41]||(s[41]=t("label",null,"Fit",-1)),t("select",{value:l.element.fit||"contain",onChange:s[14]||(s[14]=h=>o("fit",h.target.value))},s[40]||(s[40]=[t("option",{value:"contain"},"Contain",-1),t("option",{value:"cover"},"Cover",-1),t("option",{value:"fill"},"Fill",-1)]),40,fo)]),t("div",vo,[s[42]||(s[42]=t("label",null,"Border Radius",-1)),t("input",{type:"number",value:l.element.borderRadius||0,onInput:s[15]||(s[15]=h=>o("borderRadius",Number(h.target.value))),min:"0"},null,40,ho)])]),t("div",yo,[t("label",go,[t("input",{type:"checkbox",checked:l.element.shadow||!1,onChange:s[16]||(s[16]=h=>o("shadow",h.target.checked))},null,40,bo),s[43]||(s[43]=te(" Shadow "))]),t("label",wo,[t("input",{type:"checkbox",checked:l.element.flipH||!1,onChange:s[17]||(s[17]=h=>o("flipH",h.target.checked))},null,40,ko),s[44]||(s[44]=te(" Flip H "))]),t("label",xo,[t("input",{type:"checkbox",checked:l.element.flipV||!1,onChange:s[18]||(s[18]=h=>o("flipV",h.target.checked))},null,40,So),s[45]||(s[45]=te(" Flip V "))])])])):Y("",!0),l.element.type==="shape"?(y(),k("div",Eo,[s[50]||(s[50]=t("label",null,"Shape",-1)),t("div",Co,[t("div",$o,[s[47]||(s[47]=t("label",null,"Fill",-1)),t("input",{type:"color",value:l.element.fill||"#4CAF50",onInput:s[19]||(s[19]=h=>o("fill",h.target.value))},null,40,_o)]),t("div",Ao,[s[48]||(s[48]=t("label",null,"Stroke",-1)),t("input",{type:"color",value:l.element.stroke||"#2E7D32",onInput:s[20]||(s[20]=h=>o("stroke",h.target.value))},null,40,Io)])]),t("div",To,[t("div",Do,[s[49]||(s[49]=t("label",null,"Stroke Width",-1)),t("input",{type:"number",value:l.element.strokeWidth||2,onInput:s[21]||(s[21]=h=>o("strokeWidth",Number(h.target.value))),min:"0"},null,40,Mo)])])])):Y("",!0),l.element.type==="chart"?(y(),k("div",Po,[s[53]||(s[53]=t("label",null,"Chart",-1)),t("div",Fo,[t("div",Oo,[s[52]||(s[52]=t("label",null,"Type",-1)),t("select",{value:l.element.chartType,onChange:s[22]||(s[22]=h=>o("chartType",h.target.value))},s[51]||(s[51]=[Ee('<option value="bar" data-v-a5199387>Bar</option><option value="line" data-v-a5199387>Line</option><option value="pie" data-v-a5199387>Pie</option><option value="doughnut" data-v-a5199387>Doughnut</option><option value="scatter" data-v-a5199387>Scatter</option><option value="area" data-v-a5199387>Area</option>',6)]),40,Ro)])])])):Y("",!0),t("div",{class:"property-group"},[s[54]||(s[54]=t("label",null,"Layer",-1)),t("div",{class:"button-row"},[t("button",{class:"btn btn-sm",onClick:_}," ⬆️ Front "),t("button",{class:"btn btn-sm",onClick:$}," ⬇️ Back "),t("button",{class:"btn btn-sm",onClick:L}," ↑ Forward "),t("button",{class:"btn btn-sm",onClick:S}," ↓ Backward ")])]),t("div",{class:"property-group"},[s[55]||(s[55]=t("label",null,"Actions",-1)),t("div",{class:"button-row"},[t("button",{class:"btn btn-sm",onClick:T}," 📋 Duplicate "),t("button",{class:"btn btn-sm btn-danger",onClick:D}," 🗑️ Delete ")])])])]))}}),Lo=q(zo,[["__scopeId","data-v-a5199387"]]),Bo={class:"multi-element-properties"},No={class:"property-group"},Ho={class:"alignment-grid"},Yo={class:"property-group"},Uo={class:"button-row"},jo={class:"property-group"},Vo={class:"input-row"},Xo={class:"input-group"},Zo={class:"input-group"},Wo={class:"property-group"},Go={class:"input-row"},Jo={class:"input-group"},Ko=["value"],Qo={class:"input-row"},qo={class:"input-group"},es=["value"],ts={key:0,class:"property-group"},ns={class:"input-row"},os={class:"input-group"},ss=["value"],is={class:"input-group"},ls=["value"],as={class:"checkbox-row"},rs={class:"checkbox-label"},cs=["checked"],ds={class:"checkbox-label"},us=["checked"],ps=Q({__name:"MultiElementProperties",props:{elements:{}},setup(f){const e=f,n=K(),o=F({horizontal:20,vertical:20}),a=P(()=>e.elements.every(b=>b.type==="text")),g=P(()=>{const b=e.elements.map(i=>i.opacity||1);return b.every(i=>i===b[0])?b[0]:1}),_=P(()=>{const b=e.elements.map(i=>i.rotate);return b.every(i=>i===b[0])?b[0]:0}),$=P(()=>{if(!a.value)return 16;const b=e.elements.map(i=>i.fontSize||16);return b.every(i=>i===b[0])?b[0]:16}),L=P(()=>{if(!a.value)return"#333333";const b=e.elements.map(i=>i.color||i.defaultColor);return b.every(i=>i===b[0])?b[0]:"#333333"}),S=P(()=>{if(!a.value)return!1;const b=e.elements.map(i=>i.bold||!1);return b.every(i=>i===b[0])?b[0]:!1}),T=P(()=>{if(!a.value)return!1;const b=e.elements.map(i=>i.italic||!1);return b.every(i=>i===b[0])?b[0]:!1});async function D(b){const i=J();for(const c of e.elements){let M=c.left,z=c.top;switch(b){case"left":M=i.left;break;case"center-h":M=i.left+(i.width-c.width)/2;break;case"right":M=i.left+i.width-c.width;break;case"top":z=i.top;break;case"center-v":z=i.top+(i.height-c.height)/2;break;case"bottom":z=i.top+i.height-c.height;break}await n.modifyElement(c.id,{left:M,top:z})}}async function l(b){if(e.elements.length<3)return;const i=[...e.elements].sort((v,I)=>b==="horizontal"?v.left-I.left:v.top-I.top),c=i[0],M=i[i.length-1],z=b==="horizontal"?M.left+M.width-c.left:M.top+M.height-c.top,Z=i.reduce((v,I)=>v+(b==="horizontal"?I.width:I.height),0),C=(z-Z)/(i.length-1);let r=b==="horizontal"?c.left:c.top;for(let v=1;v<i.length-1;v++){const I=i[v],B=i[v-1];r+=(b==="horizontal"?B.width:B.height)+C,await n.modifyElement(I.id,{[b==="horizontal"?"left":"top"]:r})}}async function s(){const b=[...e.elements].sort((i,c)=>i.left-c.left);for(let i=1;i<b.length;i++){const c=b[i-1],M=b[i];await n.modifyElement(M.id,{left:c.left+c.width+o.value.horizontal,top:c.top+o.value.vertical})}}async function h(b,i){for(const c of e.elements)await n.modifyElement(c.id,{[b]:i})}async function j(){const b=n.currentSlide;if(!b)return;const i=Math.max(...b.elements.map(c=>c.zIndex||1));for(const c of e.elements)await n.modifyElement(c.id,{zIndex:i+1})}async function x(){const b=n.currentSlide;if(!b)return;const i=Math.min(...b.elements.map(c=>c.zIndex||1));for(const c of e.elements)await n.modifyElement(c.id,{zIndex:Math.max(0,i-1)})}async function u(){const b=ne();for(const i of e.elements)await n.modifyElement(i.id,{groupId:b})}async function p(){for(const b of e.elements)await n.modifyElement(b.id,{groupId:void 0})}async function E(){n.copyElements(e.elements.map(b=>b.id)),await n.pasteElements()}async function A(){if(confirm(`Delete ${e.elements.length} elements?`)){for(const b of e.elements)await n.removeElement(b.id);n.clearSelection()}}function J(){let b=1/0,i=1/0,c=-1/0,M=-1/0;for(const z of e.elements)b=Math.min(b,z.left),i=Math.min(i,z.top),c=Math.max(c,z.left+z.width),M=Math.max(M,z.top+z.height);return{left:b,top:i,width:c-b,height:M-i}}return(b,i)=>(y(),k("div",Bo,[t("div",No,[i[16]||(i[16]=t("label",null,"Alignment",-1)),t("div",Ho,[t("button",{class:"align-btn",onClick:i[0]||(i[0]=c=>D("left")),title:"Align Left"}," ⬅️ "),t("button",{class:"align-btn",onClick:i[1]||(i[1]=c=>D("center-h")),title:"Align Center"}," ↔️ "),t("button",{class:"align-btn",onClick:i[2]||(i[2]=c=>D("right")),title:"Align Right"}," ➡️ "),t("button",{class:"align-btn",onClick:i[3]||(i[3]=c=>D("top")),title:"Align Top"}," ⬆️ "),t("button",{class:"align-btn",onClick:i[4]||(i[4]=c=>D("center-v")),title:"Align Middle"}," ↕️ "),t("button",{class:"align-btn",onClick:i[5]||(i[5]=c=>D("bottom")),title:"Align Bottom"}," ⬇️ ")])]),t("div",Yo,[i[17]||(i[17]=t("label",null,"Distribution",-1)),t("div",Uo,[t("button",{class:"btn btn-sm",onClick:i[6]||(i[6]=c=>l("horizontal"))}," ↔️ Horizontal "),t("button",{class:"btn btn-sm",onClick:i[7]||(i[7]=c=>l("vertical"))}," ↕️ Vertical ")])]),t("div",jo,[i[20]||(i[20]=t("label",null,"Spacing",-1)),t("div",Vo,[t("div",Xo,[i[18]||(i[18]=t("label",null,"Horizontal",-1)),de(t("input",{type:"number","onUpdate:modelValue":i[8]||(i[8]=c=>o.value.horizontal=c),onChange:s,min:"0"},null,544),[[ve,o.value.horizontal]])]),t("div",Zo,[i[19]||(i[19]=t("label",null,"Vertical",-1)),de(t("input",{type:"number","onUpdate:modelValue":i[9]||(i[9]=c=>o.value.vertical=c),onChange:s,min:"0"},null,544),[[ve,o.value.vertical]])])])]),t("div",Wo,[i[23]||(i[23]=t("label",null,"Common Properties",-1)),t("div",Go,[t("div",Jo,[i[21]||(i[21]=t("label",null,"Opacity",-1)),t("input",{type:"range",value:g.value*100,onInput:i[10]||(i[10]=c=>h("opacity",Number(c.target.value)/100)),min:"0",max:"100"},null,40,Ko)])]),t("div",Qo,[t("div",qo,[i[22]||(i[22]=t("label",null,"Rotation",-1)),t("input",{type:"number",value:_.value,onInput:i[11]||(i[11]=c=>h("rotate",Number(c.target.value))),min:"0",max:"360"},null,40,es)])])]),a.value?(y(),k("div",ts,[i[28]||(i[28]=t("label",null,"Text Properties",-1)),t("div",ns,[t("div",os,[i[24]||(i[24]=t("label",null,"Font Size",-1)),t("input",{type:"number",value:$.value,onInput:i[12]||(i[12]=c=>h("fontSize",Number(c.target.value))),min:"8",max:"72"},null,40,ss)]),t("div",is,[i[25]||(i[25]=t("label",null,"Color",-1)),t("input",{type:"color",value:L.value,onInput:i[13]||(i[13]=c=>h("color",c.target.value))},null,40,ls)])]),t("div",as,[t("label",rs,[t("input",{type:"checkbox",checked:S.value,onChange:i[14]||(i[14]=c=>h("bold",c.target.checked))},null,40,cs),i[26]||(i[26]=te(" Bold "))]),t("label",ds,[t("input",{type:"checkbox",checked:T.value,onChange:i[15]||(i[15]=c=>h("italic",c.target.checked))},null,40,us),i[27]||(i[27]=te(" Italic "))])])])):Y("",!0),t("div",{class:"property-group"},[i[29]||(i[29]=t("label",null,"Layer",-1)),t("div",{class:"button-row"},[t("button",{class:"btn btn-sm",onClick:j}," ⬆️ Front "),t("button",{class:"btn btn-sm",onClick:x}," ⬇️ Back ")])]),t("div",{class:"property-group"},[i[30]||(i[30]=t("label",null,"Group",-1)),t("div",{class:"button-row"},[t("button",{class:"btn btn-sm",onClick:u}," 🔗 Group "),t("button",{class:"btn btn-sm",onClick:p}," 🔓 Ungroup ")])]),t("div",{class:"property-group"},[i[31]||(i[31]=t("label",null,"Actions",-1)),t("div",{class:"button-row"},[t("button",{class:"btn btn-sm",onClick:E}," 📋 Duplicate "),t("button",{class:"btn btn-sm btn-danger",onClick:A}," 🗑️ Delete ")])])]))}}),ms=q(ps,[["__scopeId","data-v-fd28974b"]]),fs={class:"property-panel"},vs={class:"panel-content"},hs={key:0,class:"no-selection"},ys={key:1,class:"single-element"},gs={key:2,class:"multiple-elements"},bs={class:"selection-info"},ws=Q({__name:"PropertyPanel",setup(f){const e=K(),n=P(()=>{const o=e.currentSlide;return o?o.elements.filter(a=>e.selectedElements.includes(a.id)):[]});return(o,a)=>(y(),k("div",fs,[a[1]||(a[1]=t("div",{class:"panel-header"},[t("h3",null,"Properties")],-1)),t("div",vs,[n.value.length===0?(y(),k("div",hs,a[0]||(a[0]=[t("div",{class:"no-selection-icon"},"🎯",-1),t("p",null,"Select an element to edit its properties",-1)]))):n.value.length===1?(y(),k("div",ys,[le(Lo,{element:n.value[0]},null,8,["element"])])):(y(),k("div",gs,[t("div",bs,[t("strong",null,H(n.value.length)+" elements selected",1)]),le(ms,{elements:n.value},null,8,["elements"])]))])]))}}),ks=q(ws,[["__scopeId","data-v-17f16050"]]),xs={class:"ai-suggestions-overlay"},Ss={class:"suggestions-container"},Es={class:"suggestions-header"},Cs={class:"suggestions-content"},$s=["onClick"],_s={class:"suggestion-icon"},As={class:"suggestion-details"},Is={class:"suggestion-title"},Ts={class:"suggestion-description"},Ds={class:"suggestion-confidence"},Ms={class:"suggestion-actions"},Ps=["onClick"],Fs=["onClick"],Os={class:"suggestions-footer"},Rs=Q({__name:"AISuggestions",setup(f){const e=he(),n=K();async function o(S){try{await e.executeAISuggestion(S)}catch(T){console.error("Failed to apply suggestion:",T)}}function a(S){e.aiSuggestions.splice(S,1)}async function g(){await e.generateSuggestions(n.canvas.activeSlide)}function _(S){const T={ADD:{text:"📝",image:"🖼️",shape:"🔷",chart:"📊",table:"📋"},MODIFY:"✏️",CREATE:"➕",DELETE:"🗑️",REMOVE:"❌",REORDER:"🔄",APPLY:"🎨"};return S.op==="ADD"&&typeof S.type=="string"?T.ADD[S.type]||"➕":T[S.op]||"💡"}function $(S){const T={ADD:"Add",REMOVE:"Remove",MODIFY:"Modify",CREATE:"Create",DELETE:"Delete",REORDER:"Reorder",APPLY:"Apply"},D={text:"Text",image:"Image",shape:"Shape",chart:"Chart",table:"Table",slide:"Slide",theme:"Theme"};return`${T[S.op]} ${D[S.type]||S.type}`}function L(S){switch(S.op){case"ADD":switch(S.type){case"text":return"Add a title or content text to improve slide structure";case"image":return"Add a relevant image to enhance visual appeal";case"shape":return"Add a shape to create visual hierarchy";case"chart":return"Add a chart to visualize data effectively";case"table":return"Add a table to organize information clearly";default:return`Add a new ${S.type} element`}case"MODIFY":return"Improve styling and positioning for better visual impact";case"CREATE":return"Create a new slide with optimized layout";case"APPLY":return S.type==="theme"?"Apply a cohesive theme for professional appearance":`Apply ${S.type} improvements`;case"REORDER":return"Reorganize elements for better flow and readability";default:return`AI suggests this ${S.op.toLowerCase()} operation`}}return(S,T)=>(y(),k("div",xs,[t("div",Ss,[t("div",Es,[T[2]||(T[2]=t("h3",null,"🤖 AI Suggestions",-1)),t("button",{class:"close-btn",onClick:T[0]||(T[0]=D=>O(e).clearSuggestions())},"×")]),t("div",Cs,[(y(!0),k(ee,null,oe(O(e).aiSuggestions,(D,l)=>(y(),k("div",{key:l,class:"suggestion-card",onClick:s=>o(D)},[t("div",_s,H(_(D)),1),t("div",As,[t("div",Is,H($(D)),1),t("div",Ts,H(L(D)),1),t("div",Ds," Confidence: "+H(Math.round(D.confidence*100)||85)+"% ",1)]),t("div",Ms,[t("button",{class:"action-btn apply-btn",onClick:fe(s=>o(D),["stop"])}," Apply ",8,Ps),t("button",{class:"action-btn dismiss-btn",onClick:fe(s=>a(l),["stop"])}," × ",8,Fs)])],8,$s))),128))]),t("div",Os,[t("button",{class:"btn btn-ghost btn-sm",onClick:T[1]||(T[1]=D=>O(e).clearSuggestions())}," Dismiss All "),t("button",{class:"btn btn-primary btn-sm",onClick:g}," Generate More ")])])]))}}),zs=q(Rs,[["__scopeId","data-v-72420aa8"]]),Ls={class:"editor"},Bs={class:"editor-header"},Ns={class:"header-left"},Hs={class:"presentation-title"},Ys={class:"header-center"},Us={class:"header-right"},js={class:"editor-content"},Vs={class:"sidebar-left"},Xs={class:"canvas-area"},Zs={class:"canvas-container"},Ws={class:"zoom-controls"},Gs={class:"zoom-level"},Js={class:"sidebar-right"},Ks={class:"status-bar"},Qs={class:"status-left"},qs={class:"status-item"},ei={key:0,class:"status-item"},ti={key:1,class:"status-item"},ni={class:"status-right"},oi={class:"status-item"},si={class:"status-item"},ii=Q({__name:"Editor",setup(f){const e=K(),n=he();ae(()=>{document.addEventListener("keydown",o);const l=window.location.pathname.split("/")[2];l&&T(l),setInterval(D,3e4)}),re(()=>{document.removeEventListener("keydown",o)});function o(l){if(l.ctrlKey||l.metaKey)switch(l.key){case"z":l.preventDefault(),l.shiftKey?e.redo():e.undo();break;case"c":l.preventDefault(),e.selectedElements.length>0&&e.copyElements(e.selectedElements);break;case"v":l.preventDefault(),e.pasteElements();break;case"s":l.preventDefault(),D();break;case"n":l.preventDefault(),e.createSlide();break}switch(l.key){case"Delete":case"Backspace":e.selectedElements.length>0&&(l.preventDefault(),e.selectedElements.forEach(h=>{e.removeElement(h)}),e.clearSelection());break;case"ArrowLeft":(l.ctrlKey||l.metaKey)&&(l.preventDefault(),$());break;case"ArrowRight":(l.ctrlKey||l.metaKey)&&(l.preventDefault(),L());break;case"Escape":e.clearSelection();break}}function a(){e.setZoom(e.canvas.zoom*1.2)}function g(){e.setZoom(e.canvas.zoom/1.2)}function _(){e.setZoom(1),e.setCanvasOffset(0,0)}function $(){const l=Math.max(0,e.canvas.activeSlide-1);e.setActiveSlide(l)}function L(){const l=Math.min(e.totalSlides-1,e.canvas.activeSlide+1);e.setActiveSlide(l)}function S(){console.log("Starting presentation...")}async function T(l){try{const s=await fetch(`/api/presentations/${l}`);if(s.ok){const h=await s.json();e.loadPresentation(h)}}catch(s){console.error("Failed to load presentation:",s)}}async function D(){try{const l=e.exportPresentation();(await fetch(`/api/presentations/${l.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})).ok&&console.log("✅ Auto-saved presentation")}catch(l){console.warn("Auto-save failed:",l)}}return(l,s)=>(y(),k("div",Ls,[t("header",Bs,[t("div",Ns,[s[1]||(s[1]=t("div",{class:"logo"},[t("span",{class:"logo-icon"},"🎯"),t("span",{class:"logo-text"},"AI-PPT")],-1)),t("div",Hs,[de(t("input",{"onUpdate:modelValue":s[0]||(s[0]=h=>O(e).presentation.title=h),class:"title-input",placeholder:"Presentation Title"},null,512),[[ve,O(e).presentation.title]])])]),t("div",Ys,[le(lt)]),t("div",Us,[le(Bt),t("button",{class:"btn btn-primary",onClick:S},s[2]||(s[2]=[t("span",null,"▶",-1),te(" Present ")]))])]),t("div",js,[t("aside",Vs,[le(tn)]),t("main",Xs,[t("div",Zs,[le($n)]),t("div",Ws,[t("button",{class:"btn btn-sm",onClick:g},"-"),t("span",Gs,H(Math.round(O(e).canvas.zoom*100))+"%",1),t("button",{class:"btn btn-sm",onClick:a},"+"),t("button",{class:"btn btn-sm",onClick:_},"Fit")])]),t("aside",Js,[le(ks)])]),t("footer",Ks,[t("div",Qs,[t("span",qs," Slide "+H(O(e).canvas.activeSlide+1)+" of "+H(O(e).totalSlides),1),O(n).isAIReady?(y(),k("span",ei," 🤖 AI Ready ")):Y("",!0),O(n).suggestionCount>0?(y(),k("span",ti," 💡 "+H(O(n).suggestionCount)+" suggestions ",1)):Y("",!0)]),t("div",ni,[t("span",oi,H(O(e).getPerformanceMetrics().totalOperations||0)+" operations ",1),t("span",si,H(O(e).presentation.settings.width)+"×"+H(O(e).presentation.settings.height),1)])]),O(n).suggestionCount>0?(y(),me(zs,{key:0})):Y("",!0)]))}}),Ae=q(ii,[["__scopeId","data-v-b2d15c7e"]]),li=Re({history:ze(),routes:[{path:"/",name:"Editor",component:Ae},{path:"/presentation/:id",name:"Presentation",component:Ae,props:!0}]}),ke=Le(Ze);ke.use(Ve);ke.use(li);ke.mount("#app");ke.config.errorHandler=(f,e,n)=>{console.error("Global error:",f,n)};
//# sourceMappingURL=index-BMSRa7Uh.js.map
