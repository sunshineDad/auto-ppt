var Me=Object.defineProperty;var Pe=(a,e,n)=>e in a?Me(a,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[e]=n;var we=(a,e,n)=>Pe(a,typeof e!="symbol"?e+"":e,n);import{d as Te,r as F,c as P,a as Fe,b as ee,o as ce,e as de,f as Re,g as k,h as g,i as re,j as t,u as R,k as Y,F as ne,l as ie,m as oe,n as Z,t as H,p as le,w as he,q as pe,v as ge,s as Oe,x as $e,y as ze,z as xe,A as ve,B as Le,C as Be,D as Ne}from"./vendor-BoTslUNd.js";import{C as Ie,r as He}from"./charts-BOVB5OMx.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const y of r)if(y.type==="childList")for(const I of y.addedNodes)I.tagName==="LINK"&&I.rel==="modulepreload"&&o(I)}).observe(document,{childList:!0,subtree:!0});function n(r){const y={};return r.integrity&&(y.integrity=r.integrity),r.referrerPolicy&&(y.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?y.credentials="include":r.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function o(r){if(r.ep)return;r.ep=!0;const y=n(r);fetch(r.href,y)}})();let ke;const Ye=new Uint8Array(16);function Ue(){if(!ke&&(ke=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ke))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ke(Ye)}const J=[];for(let a=0;a<256;++a)J.push((a+256).toString(16).slice(1));function je(a,e=0){return J[a[e+0]]+J[a[e+1]]+J[a[e+2]]+J[a[e+3]]+"-"+J[a[e+4]]+J[a[e+5]]+"-"+J[a[e+6]]+J[a[e+7]]+"-"+J[a[e+8]]+J[a[e+9]]+"-"+J[a[e+10]]+J[a[e+11]]+J[a[e+12]]+J[a[e+13]]+J[a[e+14]]+J[a[e+15]]}const Ve=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),_e={randomUUID:Ve};function se(a,e,n){if(_e.randomUUID&&!a)return _e.randomUUID();a=a||{};const o=a.random||(a.rng||Ue)();return o[6]=o[6]&15|64,o[8]=o[8]&63|128,je(o)}var V=(a=>(a.ADD="ADD",a.REMOVE="REMOVE",a.MODIFY="MODIFY",a.CREATE="CREATE",a.DELETE="DELETE",a.REORDER="REORDER",a.APPLY="APPLY",a))(V||{}),X=(a=>(a.TEXT="text",a.IMAGE="image",a.SHAPE="shape",a.CHART="chart",a.TABLE="table",a.VIDEO="video",a.AUDIO="audio",a.SLIDE="slide",a.THEME="theme",a.TEMPLATE="template",a.ANIMATION="animation",a))(X||{});class Xe{constructor(e){we(this,"presentation");we(this,"operationHistory",[]);we(this,"listeners",[]);this.presentation=e}async execute(e){const n=performance.now();try{let o;switch(e.op){case V.ADD:o=await this.executeAdd(e);break;case V.REMOVE:o=await this.executeRemove(e);break;case V.MODIFY:o=await this.executeModify(e);break;case V.CREATE:o=await this.executeCreate(e);break;case V.DELETE:o=await this.executeDelete(e);break;case V.REORDER:o=await this.executeReorder(e);break;case V.APPLY:o=await this.executeApply(e);break;default:throw new Error(`Unknown operation: ${e.op}`)}this.operationHistory.push(e),this.presentation.metadata.updatedAt=Date.now(),this.notifyListeners(e,o);const r=performance.now()-n;return console.log(`✅ Executed ${e.op} in ${r.toFixed(2)}ms`),o}catch(o){throw console.error(`❌ Failed to execute ${e.op}:`,o),o}}async executeAdd(e){const n=e.target,o=this.presentation.slides[n];if(!o)throw new Error(`Slide ${n} not found`);let r;switch(e.type){case X.TEXT:r=this.createTextElement(e.data);break;case X.IMAGE:r=this.createImageElement(e.data);break;case X.SHAPE:r=this.createShapeElement(e.data);break;case X.CHART:r=this.createChartElement(e.data);break;case X.TABLE:r=this.createTableElement(e.data);break;default:throw new Error(`Unsupported element type: ${e.type}`)}return o.elements.push(r),o.updatedAt=Date.now(),r}async executeRemove(e){var n;if(e.type==="element"){const o=e.target;return this.removeElementById(o)}if(e.type==="elements")return e.target.every(r=>this.removeElementById(r));if(e.type==="all"){const o=e.target,r=(n=e.data)==null?void 0:n.elementType;return this.removeAllElementsOfType(o,r)}return!1}async executeModify(e){if(e.type==="element"){const n=e.target;return this.modifyElement(n,e.data)}return e.type==="batch"?e.target.every(o=>this.modifyElement(o,e.data)):!1}async executeCreate(e){if(e.type===X.SLIDE)return this.createSlide(e.data);if(e.type==="slides")return this.createMultipleSlides(e.data);throw new Error(`Unsupported create type: ${e.type}`)}async executeDelete(e){if(e.type===X.SLIDE){const n=e.target;return this.deleteSlide(n)}if(e.type==="slides"){const n=e.target;return this.deleteMultipleSlides(n)}if(e.type==="slide-range"){const{from:n,to:o}=e.data;return this.deleteSlideRange(n,o)}return!1}async executeReorder(e){if(e.type==="slides")return this.reorderSlides(e.data);if(e.type==="elements"){const n=e.target;return this.reorderElements(n,e.data)}return!1}async executeApply(e){switch(e.type){case X.THEME:return this.applyTheme(e.data);case"transitions":return this.applyTransitions(e.data);case"layout":return this.applyLayout(e.data);case"animations":return this.applyAnimations(e.data);case"brand":return this.applyBrand(e.data);default:return!1}}createTextElement(e){return{id:se(),type:"text",left:e.x,top:e.y,width:e.width||400,height:e.height||100,rotate:0,content:e.content,defaultFontName:e.fontFamily||"Arial",defaultColor:e.color||"#333333",fontSize:e.fontSize||16,fontFamily:e.fontFamily||"Arial",bold:e.bold||!1,italic:e.italic||!1,underline:e.underline||!1,align:e.align||"left",lineHeight:e.lineHeight||1.5,opacity:1}}createImageElement(e){return{id:se(),type:"image",left:e.x,top:e.y,width:e.width,height:e.height,rotate:0,src:e.src,fit:e.fit||"contain",shadow:e.shadow||!1,borderRadius:e.borderRadius||0,filter:e.filter,brightness:e.brightness||1,contrast:e.contrast||1,opacity:1}}createShapeElement(e){return{id:se(),type:"shape",left:e.x,top:e.y,width:e.width,height:e.height,rotate:0,shape:e.shape,fill:e.fill||"#4CAF50",stroke:e.stroke||"#2E7D32",strokeWidth:e.strokeWidth||2,opacity:e.opacity||1}}createChartElement(e){return{id:se(),type:"chart",left:e.x,top:e.y,width:e.width,height:e.height,rotate:0,chartType:e.chartType,data:e.data,options:e.options||{}}}createTableElement(e){var n,o;return{id:se(),type:"table",left:e.x,top:e.y,width:e.width||600,height:e.height||400,rotate:0,data:e.data,colWidths:new Array(e.columns).fill(100),rowHeights:new Array(e.rows).fill(40),style:{borderColor:"#ddd",borderWidth:1,headerBg:((n=e.headerStyle)==null?void 0:n.backgroundColor)||"#1976D2",headerColor:((o=e.headerStyle)==null?void 0:o.color)||"#FFFFFF",cellPadding:8}}}removeElementById(e){for(const n of this.presentation.slides){const o=n.elements.findIndex(r=>r.id===e);if(o!==-1)return n.elements.splice(o,1),n.updatedAt=Date.now(),!0}return!1}removeAllElementsOfType(e,n){const o=this.presentation.slides[e];if(!o)return!1;const r=o.elements.length;return o.elements=o.elements.filter(y=>y.type!==n),o.updatedAt=Date.now(),o.elements.length<r}modifyElement(e,n){for(const o of this.presentation.slides){const r=o.elements.find(y=>y.id===e);if(r)return Object.assign(r,n),o.updatedAt=Date.now(),!0}return!1}createSlide(e){const n={id:se(),elements:[],layout:e.layout||"blank",template:e.template,createdAt:Date.now(),updatedAt:Date.now()};if(e.elements)for(const r of e.elements){const y=this.createElementFromData(r);y&&n.elements.push(y)}const o=e.after==="end"?this.presentation.slides.length:(e.after||0)+1;return this.presentation.slides.splice(o,0,n),n}createMultipleSlides(e){const n=[];for(let o=0;o<e.count;o++){const r=this.createSlide({layout:e.layout,after:e.after==="end"?"end":e.after+o});n.push(r)}return n}deleteSlide(e){return e>=0&&e<this.presentation.slides.length?(this.presentation.slides.splice(e,1),!0):!1}deleteMultipleSlides(e){const n=[...e].sort((o,r)=>r-o);for(const o of n)if(!this.deleteSlide(o))return!1;return!0}deleteSlideRange(e,n){return e>n||e<0||n>=this.presentation.slides.length?!1:(this.presentation.slides.splice(e,n-e+1),!0)}reorderSlides(e){if(e.order){const n=e.order.map(o=>this.presentation.slides[o]);return this.presentation.slides=n,!0}return e.sortBy?(this.presentation.slides.sort((n,o)=>e.direction==="descending"?o.createdAt-n.createdAt:n.createdAt-o.createdAt),!0):!1}reorderElements(e,n){const o=this.presentation.slides[e];if(!o)return!1;const r=n.order.map(y=>o.elements.find(I=>I.id===y)).filter(Boolean);return o.elements=r,o.updatedAt=Date.now(),!0}applyTheme(e){return this.presentation.theme={...this.presentation.theme,name:e.name,colors:e.colorScheme,fonts:e.fonts||this.presentation.theme.fonts},!0}applyTransitions(e){const n=e.applyTo==="all"?this.presentation.slides:e.applyTo.map(o=>this.presentation.slides[o]);for(const o of n)o.animation={type:e.slideTransition,duration:e.duration},o.updatedAt=Date.now();return!0}applyLayout(e){return!0}applyAnimations(e){for(const n of this.presentation.slides)for(const o of n.elements)n.updatedAt=Date.now();return!0}applyBrand(e){return e.fonts&&(this.presentation.theme.fonts=e.fonts),!0}createElementFromData(e){switch(e.type){case X.TEXT:return this.createTextElement(e);case X.IMAGE:return this.createImageElement(e);case X.SHAPE:return this.createShapeElement(e);default:return null}}onOperation(e){this.listeners.push(e)}notifyListeners(e,n){this.listeners.forEach(o=>o(e,n))}getPresentation(){return this.presentation}getOperationHistory(){return[...this.operationHistory]}getPerformanceMetrics(){return{totalOperations:this.operationHistory.length,averageExecutionTime:"< 10ms",memoryUsage:typeof window<"u"?"Browser Environment":"N/A"}}}const q=Te("presentation",()=>{const a=F(Ae()),e=F(Ce()),n=F({past:[],present:null,future:[]}),o=F([]),r=F(!1),y=F(!1),I=F([]),$=F(null),L=P(()=>a.value.slides[e.value.activeSlide]||null),S=P(()=>a.value.slides.length),D=P(()=>n.value.past.length>0),T=P(()=>n.value.future.length>0);function l(){$.value=new Xe(a.value),$.value.onOperation((f,w)=>{A(),N(f,w)})}async function s(f){$.value||l();try{const w=await $.value.execute(f);return a.value=$.value.getPresentation(),w}catch(w){throw console.error("Failed to execute atomic operation:",w),w}}async function h(f,w){const O={op:V.ADD,type:X.TEXT,target:f,data:w,timestamp:Date.now()};return s(O)}async function j(f,w){const O={op:V.ADD,type:X.IMAGE,target:f,data:w,timestamp:Date.now()};return s(O)}async function x(f,w){const O={op:V.ADD,type:X.SHAPE,target:f,data:w,timestamp:Date.now()};return s(O)}async function p(f,w){const O={op:V.ADD,type:X.CHART,target:f,data:w,timestamp:Date.now()};return s(O)}async function m(f,w){const O={op:V.ADD,type:X.TABLE,target:f,data:w,timestamp:Date.now()};return s(O)}async function E(f){const w={op:V.REMOVE,type:"element",target:f,timestamp:Date.now()};return s(w)}async function _(f,w){const O={op:V.MODIFY,type:"element",target:f,data:w,timestamp:Date.now()};return s(O)}async function Q(f={}){const w={op:V.CREATE,type:X.SLIDE,target:e.value.activeSlide,data:{after:e.value.activeSlide,...f},timestamp:Date.now()},O=await s(w);return e.value.activeSlide=Math.min(e.value.activeSlide+1,S.value-1),O}async function b(f){const w={op:V.DELETE,type:X.SLIDE,target:f,timestamp:Date.now()},O=await s(w);return e.value.activeSlide>=S.value&&(e.value.activeSlide=Math.max(0,S.value-1)),O}async function i(f){const w={op:V.REORDER,type:"slides",target:f,data:{order:f},timestamp:Date.now()};return s(w)}async function d(f){const w={op:V.APPLY,type:X.THEME,target:"all",data:f,timestamp:Date.now()};return s(w)}function M(f){f>=0&&f<S.value&&(e.value.activeSlide=f,I.value=[])}function z(f){e.value.zoom=Math.max(.1,Math.min(5,f))}function G(f,w){e.value.offsetX=f,e.value.offsetY=w}function C(f){I.value=f}function c(f){const w=I.value.indexOf(f);w===-1?I.value.push(f):I.value.splice(w,1)}function v(){I.value=[]}function A(){n.value.past.push(JSON.parse(JSON.stringify(a.value))),n.value.future=[],n.value.past.length>50&&n.value.past.shift()}function B(){if(D.value){n.value.future.unshift(JSON.parse(JSON.stringify(a.value)));const f=n.value.past.pop();a.value=f,l()}}function U(){if(T.value){n.value.past.push(JSON.parse(JSON.stringify(a.value)));const f=n.value.future.shift();a.value=f,l()}}function K(f){var O;const w=((O=L.value)==null?void 0:O.elements.filter(W=>f.includes(W.id)))||[];o.value=JSON.parse(JSON.stringify(w))}async function me(){if(o.value.length===0)return;const f=[];for(const w of o.value){const O={...w,id:se(),left:w.left+20,top:w.top+20};f.push({op:V.ADD,type:w.type,target:e.value.activeSlide,data:O,timestamp:Date.now()})}for(const w of f)await s(w)}function ue(){a.value=Ae(),e.value=Ce(),n.value={past:[],present:null,future:[]},I.value=[],l()}function Ee(f){a.value=f,e.value=Ce(),n.value={past:[],present:null,future:[]},I.value=[],l()}function be(){return JSON.parse(JSON.stringify(a.value))}function u(){var f;return((f=$.value)==null?void 0:f.getPerformanceMetrics())||{}}async function N(f,w){var O;try{(await fetch("/api/operations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({operation:f,result:w,presentationId:a.value.id,slideIndex:e.value.activeSlide,context:{totalSlides:S.value,currentElements:((O=L.value)==null?void 0:O.elements.length)||0,selectedElements:I.value.length}})})).ok||console.warn("Failed to send operation to backend")}catch(W){console.warn("Backend communication error:",W)}}return l(),{presentation:a,canvas:e,history:n,clipboard:o,isPlaying:r,isFullscreen:y,selectedElements:I,currentSlide:L,totalSlides:S,canUndo:D,canRedo:T,executeAtomicOperation:s,addText:h,addImage:j,addShape:x,addChart:p,addTable:m,removeElement:E,modifyElement:_,createSlide:Q,deleteSlide:b,reorderSlides:i,applyTheme:d,setActiveSlide:M,setZoom:z,setCanvasOffset:G,selectElements:C,toggleElementSelection:c,clearSelection:v,saveToHistory:A,undo:B,redo:U,copyElements:K,pasteElements:me,newPresentation:ue,loadPresentation:Ee,exportPresentation:be,getPerformanceMetrics:u}});function Ae(){const a={id:se(),name:"Default",colors:{primary:"#1976D2",secondary:"#424242",background:"#FFFFFF",text:"#333333",accent:"#FF5722"},fonts:{heading:"Arial",body:"Arial"},layouts:{},templates:{}},e={id:se(),elements:[],layout:"blank",createdAt:Date.now(),updatedAt:Date.now()};return{id:se(),title:"New Presentation",slides:[e],theme:a,settings:{width:1920,height:1080,ratio:"16:9"},metadata:{author:"AI-PPT User",createdAt:Date.now(),updatedAt:Date.now(),version:"1.0.0",tags:[]}}}function Ce(){return{zoom:1,offsetX:0,offsetY:0,selectedElements:[],activeSlide:0,gridVisible:!1,guidesVisible:!1,snapToGrid:!0}}const ye=Te("ai",()=>{const a=F(!1),e=F([]),n=F([]),o=F([]),r=F(0),y=F({accuracy:0,totalOperations:0,successfulPredictions:0,averageConfidence:0}),I=P(()=>e.value.length>0?e.value[0]:null),$=P(()=>y.value.totalOperations>100&&y.value.accuracy>.7),L=P(()=>o.value.length);async function S(C){try{const c=await fetch("/api/ai/predict",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({context:C})});if(!c.ok)throw new Error("Failed to get AI prediction");const v=await c.json();return e.value.unshift(v),e.value.length>10&&(e.value=e.value.slice(0,10)),v}catch(c){return console.error("AI prediction error:",c),null}}async function D(C){var A,B;const c=q(),v={currentSlide:{index:C,elements:((A=c.currentSlide)==null?void 0:A.elements)||[],layout:((B=c.currentSlide)==null?void 0:B.layout)||"blank"},presentation:{totalSlides:c.totalSlides,theme:c.presentation.theme.name,purpose:"general"},userBehavior:{recentOperations:await E(),patterns:await _(),preferences:await Q()}};try{const U=await fetch("/api/ai/suggestions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({context:v})});if(!U.ok)throw new Error("Failed to get AI suggestions");const K=await U.json();return o.value=K,K}catch(U){return console.error("AI suggestions error:",U),[]}}async function T(C){const c=q();try{await c.executeAtomicOperation(C);const v=o.value.findIndex(A=>A.op===C.op&&A.type===C.type&&A.timestamp===C.timestamp);v!==-1&&o.value.splice(v,1),y.value.successfulPredictions++,b()}catch(v){throw console.error("Failed to execute AI suggestion:",v),v}}async function l(C,c){try{(await fetch("/api/ai/learn",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({operation:C,result:c,timestamp:Date.now()})})).ok&&(y.value.totalOperations++,b())}catch(v){console.error("AI learning error:",v)}}async function s(C){a.value=!0,r.value=0;try{const c=await fetch("/api/ai/generate-presentation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:C})});if(!c.ok)throw new Error("Failed to generate presentation");const v=await c.json();return n.value.push(v),v}catch(c){throw console.error("Presentation generation error:",c),c}finally{a.value=!1,r.value=0}}async function h(C){const c=q();for(let v=0;v<C.atoms.length;v++){const A=C.atoms[v];try{await c.executeAtomicOperation(A),r.value=(v+1)/C.atoms.length*100,await new Promise(B=>setTimeout(B,100))}catch(B){console.error(`Failed to execute operation ${v}:`,B);break}}}async function j(){try{const C=await fetch("/api/ai/analyze-patterns");if(!C.ok)throw new Error("Failed to analyze patterns");return await C.json()}catch(C){return console.error("Pattern analysis error:",C),[]}}async function x(){try{const C=await fetch("/api/ai/sequences");if(!C.ok)throw new Error("Failed to get operation sequences");const c=await C.json();return n.value=c,c}catch(C){return console.error("Failed to get sequences:",C),[]}}function p(){o.value=[]}function m(){e.value=[]}async function E(){try{const C=await fetch("/api/operations/recent");if(C.ok)return await C.json()}catch(C){console.error("Failed to get recent operations:",C)}return[]}async function _(){try{const C=await fetch("/api/ai/patterns");if(C.ok)return await C.json()}catch(C){console.error("Failed to get operation patterns:",C)}return[]}async function Q(){try{const C=await fetch("/api/user/preferences");if(C.ok)return await C.json()}catch(C){console.error("Failed to get user preferences:",C)}return{}}function b(){y.value.totalOperations>0&&(y.value.accuracy=y.value.successfulPredictions/y.value.totalOperations)}let i=null;function d(){i||(i=setInterval(async()=>{const C=q();$.value&&o.value.length<3&&await D(C.canvas.activeSlide)},5e3))}function M(){i&&(clearInterval(i),i=null)}async function z(C){try{const c=await fetch("/api/ai/suggest-template",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:C})});if(c.ok){const{template:v}=await c.json();return v}}catch(c){console.error("Template suggestion error:",c)}return"blank"}async function G(C,c){try{const v=await fetch("/api/ai/enhance-content",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({elementId:C,content:c})});if(v.ok){const{enhancedContent:A}=await v.json();return A}}catch(v){console.error("Content enhancement error:",v)}return c}return{isLearning:a,predictions:e,operationSequences:n,aiSuggestions:o,learningProgress:r,modelMetrics:y,topPrediction:I,isAIReady:$,suggestionCount:L,predictNextAtom:S,generateSuggestions:D,executeAISuggestion:T,learnFromOperation:l,generatePresentation:s,executeOperationSequence:h,analyzeUserPatterns:j,getOperationSequences:x,clearSuggestions:p,clearPredictions:m,startAutoSuggestions:d,stopAutoSuggestions:M,suggestTemplate:z,enhanceContent:G}}),Ze=Fe(),We={id:"app",class:"app"},Ge=ee({__name:"App",setup(a){const e=ye();ce(()=>{e.startAutoSuggestions(),document.addEventListener("keydown",n)}),de(()=>{e.stopAutoSuggestions(),document.removeEventListener("keydown",n)});function n(o){if(o.ctrlKey||o.metaKey)switch(o.key){case"s":o.preventDefault();break;case"z":o.shiftKey,o.preventDefault();break}}return(o,r)=>{const y=Re("router-view");return g(),k("div",We,[re(y)])}}}),Je={class:"toolbar-main"},Ke={class:"toolbar-section"},Qe=["disabled"],qe=["disabled"],et={class:"toolbar-section"},tt={key:0,class:"dropdown-menu"},nt={class:"toolbar-section"},ot=["disabled"],st={class:"toolbar-section"},it={key:0,class:"dropdown-menu"},lt=["onClick"],at=ee({__name:"ToolbarMain",setup(a){const e=q(),n=F(!1),o=F(!1),r=F(),y=F(),I=F([{name:"Default",colors:{primary:"#1976D2",secondary:"#424242",background:"#FFFFFF",text:"#333333",accent:"#FF5722"}},{name:"Dark",colors:{primary:"#BB86FC",secondary:"#03DAC6",background:"#121212",text:"#FFFFFF",accent:"#CF6679"}},{name:"Nature",colors:{primary:"#4CAF50",secondary:"#8BC34A",background:"#F1F8E9",text:"#2E7D32",accent:"#FF9800"}},{name:"Ocean",colors:{primary:"#2196F3",secondary:"#00BCD4",background:"#E3F2FD",text:"#0D47A1",accent:"#FF5722"}},{name:"Sunset",colors:{primary:"#FF5722",secondary:"#FF9800",background:"#FFF3E0",text:"#BF360C",accent:"#9C27B0"}}]);function $(){n.value=!n.value,o.value=!1}function L(){o.value=!o.value,n.value=!1}function S(){n.value=!1,o.value=!1}function D(){confirm("Create a new presentation? Unsaved changes will be lost.")&&e.newPresentation()}function T(){console.log("Open presentation")}async function l(){try{const d=e.exportPresentation();(await fetch(`/api/presentations/${d.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})).ok?console.log("✅ Presentation saved"):console.error("❌ Failed to save presentation")}catch(d){console.error("Save error:",d)}}async function s(){S();const d=e.canvas.activeSlide;await e.addText(d,{content:"Click to edit text",x:100,y:100,width:300,height:60,fontSize:18,color:"#333333"})}async function h(){S();const d=document.createElement("input");d.type="file",d.accept="image/*",d.onchange=async M=>{var G;const z=(G=M.target.files)==null?void 0:G[0];if(z){const C=new FileReader;C.onload=async c=>{var B;const v=(B=c.target)==null?void 0:B.result,A=e.canvas.activeSlide;await e.addImage(A,{src:v,x:100,y:100,width:300,height:200})},C.readAsDataURL(z)}},d.click()}async function j(){S();const d=e.canvas.activeSlide;await e.addShape(d,{shape:"rectangle",x:100,y:100,width:150,height:100,fill:"#1976D2",stroke:"#1565C0",strokeWidth:2})}async function x(){S();const d=e.canvas.activeSlide;await e.addChart(d,{chartType:"bar",data:{labels:["Q1","Q2","Q3","Q4"],datasets:[{label:"Sales",data:[30,45,60,80],backgroundColor:"#1976D2"}]},x:100,y:100,width:400,height:250})}async function p(){S();const d=e.canvas.activeSlide;await e.addTable(d,{rows:3,columns:3,data:[["Header 1","Header 2","Header 3"],["Cell 1","Cell 2","Cell 3"],["Cell 4","Cell 5","Cell 6"]],x:100,y:100,width:400,height:200})}async function m(){await e.createSlide()}async function E(){confirm("Delete this slide?")&&await e.deleteSlide(e.canvas.activeSlide)}async function _(){const d=e.currentSlide;d&&await e.createSlide({layout:d.layout,elements:d.elements.map(M=>({...M}))})}async function Q(d){S(),await e.applyTheme(d)}function b(d){return{background:`linear-gradient(45deg, ${d.colors.primary}, ${d.colors.secondary})`,width:"20px",height:"20px",borderRadius:"4px"}}function i(d){r.value&&!r.value.contains(d.target)&&(n.value=!1),y.value&&!y.value.contains(d.target)&&(o.value=!1)}return ce(()=>{document.addEventListener("click",i)}),de(()=>{document.removeEventListener("click",i)}),(d,M)=>(g(),k("div",Je,[t("div",{class:"toolbar-section"},[t("button",{class:"btn btn-ghost btn-sm",onClick:D,title:"New"}," 📄 "),t("button",{class:"btn btn-ghost btn-sm",onClick:T,title:"Open"}," 📁 "),t("button",{class:"btn btn-ghost btn-sm",onClick:l,title:"Save"}," 💾 "),M[2]||(M[2]=t("div",{class:"toolbar-divider"},null,-1))]),t("div",Ke,[t("button",{class:"btn btn-ghost btn-sm",disabled:!R(e).canUndo,onClick:M[0]||(M[0]=z=>R(e).undo()),title:"Undo"}," ↶ ",8,Qe),t("button",{class:"btn btn-ghost btn-sm",disabled:!R(e).canRedo,onClick:M[1]||(M[1]=z=>R(e).redo()),title:"Redo"}," ↷ ",8,qe),M[3]||(M[3]=t("div",{class:"toolbar-divider"},null,-1))]),t("div",et,[t("div",{class:"dropdown",ref_key:"addDropdown",ref:r},[t("button",{class:"btn btn-ghost btn-sm dropdown-trigger",onClick:$,title:"Add Element"}," ➕ Add "),n.value?(g(),k("div",tt,[t("button",{class:"dropdown-item",onClick:s}," 📝 Text "),t("button",{class:"dropdown-item",onClick:h}," 🖼️ Image "),t("button",{class:"dropdown-item",onClick:j}," 🔷 Shape "),t("button",{class:"dropdown-item",onClick:x}," 📊 Chart "),t("button",{class:"dropdown-item",onClick:p}," 📋 Table ")])):Y("",!0)],512),M[4]||(M[4]=t("div",{class:"toolbar-divider"},null,-1))]),t("div",nt,[t("button",{class:"btn btn-ghost btn-sm",onClick:m,title:"New Slide"}," 📄+ "),t("button",{class:"btn btn-ghost btn-sm",disabled:R(e).totalSlides<=1,onClick:E,title:"Delete Slide"}," 🗑️ ",8,ot),t("button",{class:"btn btn-ghost btn-sm",onClick:_,title:"Duplicate Slide"}," 📋 "),M[5]||(M[5]=t("div",{class:"toolbar-divider"},null,-1))]),t("div",st,[t("div",{class:"dropdown",ref_key:"themeDropdown",ref:y},[t("button",{class:"btn btn-ghost btn-sm dropdown-trigger",onClick:L,title:"Themes"}," 🎨 Theme "),o.value?(g(),k("div",it,[(g(!0),k(ne,null,ie(I.value,z=>(g(),k("button",{key:z.name,class:"dropdown-item theme-item",onClick:G=>Q(z)},[t("div",{class:"theme-preview",style:Z(b(z))},null,4),oe(" "+H(z.name),1)],8,lt))),128))])):Y("",!0)],512)])]))}}),te=(a,e)=>{const n=a.__vccOpts||a;for(const[o,r]of e)n[o]=r;return n},rt=te(at,[["__scopeId","data-v-2ade5cd8"]]),ct={class:"ai-panel"},dt={key:0,class:"suggestion-badge"},ut={key:0,class:"ai-panel-content"},pt={class:"ai-header"},mt={class:"ai-body"},ft={class:"ai-status"},vt={key:0},ht={key:1},gt={class:"quick-actions"},yt=["disabled"],bt=["disabled"],wt=["disabled"],kt={key:0,class:"suggestions"},xt={class:"suggestion-list"},St={class:"suggestion-content"},Et={class:"suggestion-title"},Ct={class:"suggestion-description"},$t={class:"suggestion-actions"},It=["onClick"],_t=["onClick"],At={class:"ai-metrics"},Dt={class:"metric"},Tt={class:"metric"},Mt={class:"metric"},Pt={class:"modal-header"},Ft={class:"modal-body"},Rt={class:"form-group"},Ot={class:"form-group"},zt={class:"form-group"},Lt={class:"modal-footer"},Bt=["disabled"],Nt=ee({__name:"AIPanel",setup(a){const e=ye(),n=q(),o=F(!1),r=F(!1),y=F(""),I=F("business"),$=F(10);function L(){o.value=!o.value}async function S(){await e.generateSuggestions(n.canvas.activeSlide)}async function D(){n.currentSlide&&await e.generateSuggestions(n.canvas.activeSlide)}async function T(){if(y.value.trim())try{const x=`${y.value}

Type: ${I.value}
Slides: ${$.value}`,p=await e.generatePresentation(x);n.newPresentation(),await e.executeOperationSequence(p),r.value=!1,y.value=""}catch(x){console.error("Failed to generate presentation:",x),alert("Failed to generate presentation. Please try again.")}}async function l(x){try{await e.executeAISuggestion(x)}catch(p){console.error("Failed to apply suggestion:",p),alert("Failed to apply suggestion. Please try again.")}}function s(x){e.aiSuggestions.splice(x,1)}function h(x){const p={ADD:"Add",REMOVE:"Remove",MODIFY:"Modify",CREATE:"Create",DELETE:"Delete",REORDER:"Reorder",APPLY:"Apply"},m={text:"Text",image:"Image",shape:"Shape",chart:"Chart",table:"Table",slide:"Slide",theme:"Theme"};return`${p[x.op]} ${m[x.type]||x.type}`}function j(x){switch(x.op){case"ADD":return`Add a new ${x.type} element to enhance your slide`;case"MODIFY":return"Improve the styling and positioning of existing elements";case"CREATE":return"Create a new slide with optimized layout";case"APPLY":return`Apply ${x.type} to improve visual consistency`;default:return`Suggested ${x.op.toLowerCase()} operation`}}return(x,p)=>(g(),k("div",ct,[t("button",{class:le(["ai-toggle-btn",{active:o.value}]),onClick:L,title:"AI Assistant"},[p[9]||(p[9]=oe(" 🤖 AI ")),R(e).suggestionCount>0?(g(),k("span",dt,H(R(e).suggestionCount),1)):Y("",!0)],2),o.value?(g(),k("div",ut,[t("div",pt,[p[10]||(p[10]=t("h3",null,"AI Assistant",-1)),t("button",{class:"close-btn",onClick:p[0]||(p[0]=m=>o.value=!1)},"×")]),t("div",mt,[t("div",ft,[t("div",{class:le(["status-indicator",{ready:R(e).isAIReady}])},null,2),R(e).isAIReady?(g(),k("span",vt,"AI Ready")):(g(),k("span",ht,"Learning... ("+H(R(e).modelMetrics.totalOperations)+"/100 operations)",1))]),t("div",gt,[p[11]||(p[11]=t("h4",null,"Quick Actions",-1)),t("button",{class:"action-btn",onClick:S,disabled:R(e).isLearning}," 💡 Get Suggestions ",8,yt),t("button",{class:"action-btn",onClick:p[1]||(p[1]=m=>r.value=!0),disabled:!R(e).isAIReady}," ✨ Generate Presentation ",8,bt),t("button",{class:"action-btn",onClick:D,disabled:!R(e).isAIReady}," 🎨 Enhance Slide ",8,wt)]),R(e).suggestionCount>0?(g(),k("div",kt,[p[12]||(p[12]=t("h4",null,"Suggestions",-1)),t("div",xt,[(g(!0),k(ne,null,ie(R(e).aiSuggestions,(m,E)=>(g(),k("div",{key:E,class:"suggestion-item"},[t("div",St,[t("div",Et,H(h(m)),1),t("div",Ct,H(j(m)),1)]),t("div",$t,[t("button",{class:"btn btn-sm btn-primary",onClick:_=>l(m)}," Apply ",8,It),t("button",{class:"btn btn-sm btn-ghost",onClick:_=>s(E)}," × ",8,_t)])]))),128))])])):Y("",!0),t("div",At,[p[16]||(p[16]=t("h4",null,"AI Performance",-1)),t("div",Dt,[p[13]||(p[13]=t("span",null,"Accuracy:",-1)),t("span",null,H(Math.round(R(e).modelMetrics.accuracy*100))+"%",1)]),t("div",Tt,[p[14]||(p[14]=t("span",null,"Operations:",-1)),t("span",null,H(R(e).modelMetrics.totalOperations),1)]),t("div",Mt,[p[15]||(p[15]=t("span",null,"Successful Predictions:",-1)),t("span",null,H(R(e).modelMetrics.successfulPredictions),1)])])])])):Y("",!0),r.value?(g(),k("div",{key:1,class:"modal-overlay",onClick:p[8]||(p[8]=m=>r.value=!1)},[t("div",{class:"modal-content",onClick:p[7]||(p[7]=he(()=>{},["stop"]))},[t("div",Pt,[p[17]||(p[17]=t("h3",null,"Generate Presentation",-1)),t("button",{class:"close-btn",onClick:p[2]||(p[2]=m=>r.value=!1)},"×")]),t("div",Ft,[t("div",Rt,[p[18]||(p[18]=t("label",null,"Describe your presentation:",-1)),pe(t("textarea",{"onUpdate:modelValue":p[3]||(p[3]=m=>y.value=m),placeholder:"e.g., A quarterly business review with sales data, market analysis, and future projections",rows:"4"},null,512),[[ge,y.value]])]),t("div",Ot,[p[20]||(p[20]=t("label",null,"Presentation type:",-1)),pe(t("select",{"onUpdate:modelValue":p[4]||(p[4]=m=>I.value=m)},p[19]||(p[19]=[$e('<option value="business" data-v-d01b2e69>Business</option><option value="educational" data-v-d01b2e69>Educational</option><option value="marketing" data-v-d01b2e69>Marketing</option><option value="technical" data-v-d01b2e69>Technical</option><option value="creative" data-v-d01b2e69>Creative</option>',5)]),512),[[Oe,I.value]])]),t("div",zt,[p[21]||(p[21]=t("label",null,"Number of slides:",-1)),pe(t("input",{type:"number","onUpdate:modelValue":p[5]||(p[5]=m=>$.value=m),min:"3",max:"20",placeholder:"10"},null,512),[[ge,$.value]])])]),t("div",Lt,[t("button",{class:"btn btn-ghost",onClick:p[6]||(p[6]=m=>r.value=!1)}," Cancel "),t("button",{class:"btn btn-primary",onClick:T,disabled:!y.value.trim()||R(e).isLearning},H(R(e).isLearning?"Generating...":"Generate"),9,Bt)])])])):Y("",!0)]))}}),Ht=te(Nt,[["__scopeId","data-v-d01b2e69"]]),Yt={class:"slide-thumbnails"},Ut={class:"thumbnails-list"},jt=["onClick","onContextmenu"],Vt={class:"thumbnail-preview"},Xt={class:"slide-number"},Zt={class:"slide-content"},Wt={key:0,class:"mini-text"},Gt={key:1,class:"mini-image"},Jt={key:2,class:"mini-shape"},Kt={key:3,class:"mini-chart"},Qt={key:4,class:"mini-table"},qt={class:"thumbnail-info"},en={class:"slide-title"},tn={class:"element-count"},nn=ee({__name:"SlideThumbnails",setup(a){const e=q(),n=F({visible:!1,x:0,y:0,slideIndex:-1}),o=P(()=>({position:"fixed",left:`${n.value.x}px`,top:`${n.value.y}px`,zIndex:1e3}));function r(x){e.setActiveSlide(x)}async function y(){await e.createSlide()}function I(x,p){x.preventDefault(),n.value={visible:!0,x:x.clientX,y:x.clientY,slideIndex:p}}function $(){n.value.visible=!1}async function L(){const x=n.value.slideIndex,p=e.presentation.slides[x];p&&await e.createSlide({layout:p.layout,elements:p.elements.map(m=>({...m}))}),$()}async function S(){const x=n.value.slideIndex;e.presentation.slides.length>1&&confirm("Delete this slide?")&&await e.deleteSlide(x),$()}async function D(){const x=n.value.slideIndex;if(x>0){const p=[...e.presentation.slides],m=p.splice(x,1)[0];p.splice(x-1,0,m);const E=p.map((_,Q)=>Q);await e.reorderSlides(E),e.setActiveSlide(x-1)}$()}async function T(){const x=n.value.slideIndex,p=e.presentation.slides.length;if(x<p-1){const m=[...e.presentation.slides],E=m.splice(x,1)[0];m.splice(x+1,0,E);const _=m.map((Q,b)=>b);await e.reorderSlides(_),e.setActiveSlide(x+1)}$()}function l(x){const E=160/e.presentation.settings.width,_=90/e.presentation.settings.height;return{position:"absolute",left:`${x.left*E}px`,top:`${x.top*_}px`,width:`${x.width*E}px`,height:`${x.height*_}px`,transform:`rotate(${x.rotate}deg)`}}function s(x){if(x.type!=="text")return"";const p=x.content.replace(/<[^>]*>/g,""),m=p.split(" ").slice(0,3);return m.join(" ")+(m.length<p.split(" ").length?"...":"")}function h(x){const p=x.elements.find(E=>E.type==="text"&&E.style==="heading");if(p)return s(p);const m=x.elements.find(E=>E.type==="text");return m?s(m):""}function j(x){n.value.visible&&$()}return ce(()=>{document.addEventListener("click",j)}),de(()=>{document.removeEventListener("click",j)}),(x,p)=>(g(),k("div",Yt,[t("div",{class:"thumbnails-header"},[p[1]||(p[1]=t("h3",null,"Slides",-1)),t("button",{class:"btn btn-sm btn-primary",onClick:y}," + Add ")]),t("div",Ut,[(g(!0),k(ne,null,ie(R(e).presentation.slides,(m,E)=>(g(),k("div",{key:m.id,class:le(["thumbnail-item",{active:E===R(e).canvas.activeSlide}]),onClick:_=>r(E),onContextmenu:_=>I(_,E)},[t("div",Vt,[t("div",Xt,H(E+1),1),t("div",Zt,[(g(!0),k(ne,null,ie(m.elements,_=>(g(),k("div",{key:_.id,class:le(`mini-element mini-${_.type}`),style:Z(l(_))},[_.type==="text"?(g(),k("span",Wt,H(s(_)),1)):_.type==="image"?(g(),k("div",Gt,"🖼️")):_.type==="shape"?(g(),k("div",Jt,"🔷")):_.type==="chart"?(g(),k("div",Kt,"📊")):_.type==="table"?(g(),k("div",Qt,"📋")):Y("",!0)],6))),128))])]),t("div",qt,[t("div",en,H(h(m)||`Slide ${E+1}`),1),t("div",tn,H(m.elements.length)+" elements ",1)])],42,jt))),128))]),n.value.visible?(g(),k("div",{key:0,class:"context-menu",style:Z(o.value),onClick:p[0]||(p[0]=he(()=>{},["stop"]))},[t("button",{class:"context-item",onClick:L}," 📋 Duplicate "),t("button",{class:"context-item",onClick:S}," 🗑️ Delete "),p[2]||(p[2]=t("div",{class:"context-separator"},null,-1)),t("button",{class:"context-item",onClick:D}," ⬆️ Move Up "),t("button",{class:"context-item",onClick:T}," ⬇️ Move Down ")],4)):Y("",!0)]))}}),on=te(nn,[["__scopeId","data-v-42c97890"]]),sn=["contenteditable","innerHTML"],ln=["src"],an=["viewBox"],rn=["d","fill","stroke","stroke-width"],cn={key:3,class:"chart-element"},dn=["width","height"],un=["onDblclick"],pn=["src","poster","autoplay","loop","controls"],mn=["src","autoplay","loop"],fn={key:7,class:"selection-handles"},vn=["onMousedown"],hn=ee({__name:"ElementRenderer",props:{element:{},selected:{type:Boolean},zoom:{}},emits:["select","update","delete"],setup(a,{emit:e}){Ie.register(...He);const n=a,o=e,r=F(!1),y=F(!1),I=F(!1),$=F(!1),L=F({x:0,y:0,elementX:0,elementY:0}),S=F({x:0,y:0,width:0,height:0,handle:""}),D=F({x:0,y:0,rotation:0}),T=F(),l=F(null),s=P(()=>({position:"absolute",left:`${n.element.left}px`,top:`${n.element.top}px`,width:`${n.element.width}px`,height:`${n.element.height}px`,transform:`rotate(${n.element.rotate}deg)`,zIndex:n.element.zIndex||1,opacity:n.element.opacity||1,cursor:r.value?"grabbing":"grab"})),h=P(()=>{if(n.element.type!=="text")return{};const u=n.element;return{fontFamily:u.fontFamily||u.defaultFontName,fontSize:`${u.fontSize||16}px`,color:u.color||u.defaultColor,fontWeight:u.bold?"bold":"normal",fontStyle:u.italic?"italic":"normal",textDecoration:u.underline?"underline":"none",textAlign:u.align||"left",lineHeight:u.lineHeight||1.5,padding:"8px",outline:"none",width:"100%",height:"100%",display:"flex",alignItems:"center",backgroundColor:u.fill||"transparent"}}),j=P(()=>{if(n.element.type!=="image")return{};const u=n.element;return{width:"100%",height:"100%",objectFit:u.fit||"contain",borderRadius:u.borderRadius?`${u.borderRadius}px`:"0",filter:u.filter||"none",transform:`scaleX(${u.flipH?-1:1}) scaleY(${u.flipV?-1:1})`,boxShadow:u.shadow?"0 4px 8px rgba(0,0,0,0.2)":"none"}}),x=P(()=>({width:"100%",height:"100%"})),p=P(()=>`0 0 ${n.element.width} ${n.element.height}`),m=P(()=>{if(n.element.type!=="shape")return"";switch(n.element.shape){case"rectangle":return`M 0 0 L ${n.element.width} 0 L ${n.element.width} ${n.element.height} L 0 ${n.element.height} Z`;case"circle":const N=n.element.width/2,f=n.element.height/2,w=Math.min(N,f);return`M ${N} ${f} m -${w} 0 a ${w} ${w} 0 1 0 ${w*2} 0 a ${w} ${w} 0 1 0 -${w*2} 0`;case"triangle":return`M ${n.element.width/2} 0 L ${n.element.width} ${n.element.height} L 0 ${n.element.height} Z`;default:return`M 0 0 L ${n.element.width} 0 L ${n.element.width} ${n.element.height} L 0 ${n.element.height} Z`}}),E=P(()=>{var N,f;if(n.element.type!=="table")return{};const u=n.element;return{width:"100%",height:"100%",borderCollapse:"collapse",border:`${((N=u.style)==null?void 0:N.borderWidth)||1}px solid ${((f=u.style)==null?void 0:f.borderColor)||"#ddd"}`}}),_=P(()=>({width:"100%",height:"100%",objectFit:"contain"})),Q=P(()=>({width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"8px"})),b=P(()=>[{position:"nw",style:{top:"-4px",left:"-4px"}},{position:"n",style:{top:"-4px",left:"50%",transform:"translateX(-50%)"}},{position:"ne",style:{top:"-4px",right:"-4px"}},{position:"e",style:{top:"50%",right:"-4px",transform:"translateY(-50%)"}},{position:"se",style:{bottom:"-4px",right:"-4px"}},{position:"s",style:{bottom:"-4px",left:"50%",transform:"translateX(-50%)"}},{position:"sw",style:{bottom:"-4px",left:"-4px"}},{position:"w",style:{top:"50%",left:"-4px",transform:"translateY(-50%)"}}]);function i(u){u.stopPropagation(),o("select",n.element.id,u.ctrlKey||u.metaKey)}function d(u){u.stopPropagation(),n.element.type==="text"&&($.value=!0,xe(()=>{u.target.focus()}))}function M(u){$.value||(u.preventDefault(),u.stopPropagation(),r.value=!0,L.value={x:u.clientX,y:u.clientY,elementX:n.element.left,elementY:n.element.top},document.addEventListener("mousemove",z),document.addEventListener("mouseup",G))}function z(u){if(!(!r.value&&!y.value&&!I.value))if(r.value){const N=(u.clientX-L.value.x)/n.zoom,f=(u.clientY-L.value.y)/n.zoom;o("update",n.element.id,{left:L.value.elementX+N,top:L.value.elementY+f})}else y.value?c(u):I.value&&A(u)}function G(){r.value=!1,y.value=!1,I.value=!1,document.removeEventListener("mousemove",z),document.removeEventListener("mouseup",G)}function C(u,N){u.stopPropagation(),y.value=!0,S.value={x:u.clientX,y:u.clientY,width:n.element.width,height:n.element.height,handle:N},document.addEventListener("mousemove",z),document.addEventListener("mouseup",G)}function c(u){const N=(u.clientX-S.value.x)/n.zoom,f=(u.clientY-S.value.y)/n.zoom,w=S.value.handle;let O=S.value.width,W=S.value.height,ae=n.element.left,fe=n.element.top;w.includes("e")&&(O+=N),w.includes("w")&&(O-=N,ae+=N),w.includes("s")&&(W+=f),w.includes("n")&&(W-=f,fe+=f),O=Math.max(20,O),W=Math.max(20,W),o("update",n.element.id,{width:O,height:W,left:ae,top:fe})}function v(u){u.stopPropagation(),I.value=!0,D.value={x:u.clientX,y:u.clientY,rotation:n.element.rotate},document.addEventListener("mousemove",z),document.addEventListener("mouseup",G)}function A(u){const N=n.element.left+n.element.width/2,f=n.element.top+n.element.height/2,w=Math.atan2(D.value.y-f,D.value.x-N),W=(Math.atan2(u.clientY-f,u.clientX-N)-w)*(180/Math.PI),ae=D.value.rotation+W;o("update",n.element.id,{rotate:ae%360})}function B(){$.value=!1}function U(u){const N=u.target;o("update",n.element.id,{content:N.innerHTML})}function K(){}function me(){console.error("Failed to load image:",n.element.id)}function ue(u,N){var O,W,ae,fe;if(n.element.type!=="table")return{};const f=n.element,w=u===0;return{padding:`${((O=f.style)==null?void 0:O.cellPadding)||8}px`,border:`1px solid ${((W=f.style)==null?void 0:W.borderColor)||"#ddd"}`,backgroundColor:w?((ae=f.style)==null?void 0:ae.headerBg)||"#f5f5f5":"transparent",color:w&&((fe=f.style)==null?void 0:fe.headerColor)||"#333",fontWeight:w?"bold":"normal"}}function Ee(u,N){console.log("Edit cell:",u,N)}function be(){if(n.element.type!=="chart"||!T.value)return;const u=n.element;let N=T.value;if(!(N instanceof HTMLCanvasElement)){console.error("Chart container is not a canvas element");return}const f=N.getContext("2d");if(!f){console.error("Failed to get 2D context from canvas");return}l.value&&(l.value.destroy(),l.value=null);try{l.value=new Ie(f,{type:u.chartType||"bar",data:u.data||{labels:["Sample"],datasets:[{label:"Data",data:[1],backgroundColor:"#3498db"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0}},...u.options}})}catch(w){console.error("Failed to create chart:",w)}}return ze(()=>n.element,()=>{n.element.type==="chart"&&xe(()=>{be()})},{deep:!0}),ce(()=>{n.element.type==="chart"&&xe(()=>{be()})}),de(()=>{l.value&&l.value.destroy()}),(u,N)=>(g(),k("div",{class:le(["element-renderer",{selected:u.selected,dragging:r.value,[`element-${u.element.type}`]:!0}]),style:Z(s.value),onMousedown:M,onClick:i,onDblclick:d},[u.element.type==="text"?(g(),k("div",{key:0,class:"text-element",style:Z(h.value),contenteditable:$.value,onBlur:B,onInput:U,innerHTML:u.element.content},null,44,sn)):u.element.type==="image"?(g(),k("img",{key:1,class:"image-element",src:u.element.src,style:Z(j.value),onLoad:K,onError:me},null,44,ln)):u.element.type==="shape"?(g(),k("svg",{key:2,class:"shape-element",style:Z(x.value),viewBox:p.value},[t("path",{d:m.value,fill:u.element.fill,stroke:u.element.stroke,"stroke-width":u.element.strokeWidth},null,8,rn)],12,an)):u.element.type==="chart"?(g(),k("div",cn,[t("canvas",{ref_key:"chartContainer",ref:T,width:u.element.width||400,height:u.element.height||300},null,8,dn)])):u.element.type==="table"?(g(),k("table",{key:4,class:"table-element",style:Z(E.value)},[(g(!0),k(ne,null,ie(u.element.data,(f,w)=>(g(),k("tr",{key:w},[(g(!0),k(ne,null,ie(f,(O,W)=>(g(),k("td",{key:W,style:Z(ue(w)),onDblclick:ae=>Ee(w,W)},H(O),45,un))),128))]))),128))],4)):u.element.type==="video"?(g(),k("video",{key:5,class:"video-element",src:u.element.src,poster:u.element.poster,autoplay:u.element.autoplay,loop:u.element.loop,controls:u.element.controls,style:Z(_.value)},null,12,pn)):u.element.type==="audio"?(g(),k("div",{key:6,class:"audio-element",style:Z(Q.value)},[t("div",{class:"audio-icon",style:Z({color:u.element.iconColor})},"🔊",4),t("audio",{src:u.element.src,autoplay:u.element.autoplay,loop:u.element.loop,controls:""},null,8,mn)],4)):Y("",!0),u.selected&&!$.value?(g(),k("div",fn,[(g(!0),k(ne,null,ie(b.value,f=>(g(),k("div",{key:f.position,class:le(`handle handle-${f.position}`),style:Z(f.style),onMousedown:w=>C(w,f.position)},null,46,vn))),128))])):Y("",!0),u.selected&&!$.value?(g(),k("div",{key:8,class:"rotation-handle",onMousedown:v},N[0]||(N[0]=[t("div",{class:"rotation-icon"},"↻",-1)]),32)):Y("",!0)],38))}}),gn=te(hn,[["__scopeId","data-v-95447ead"]]),yn=ee({__name:"SelectionBox",props:{box:{}},setup(a){const e=a,n=P(()=>({position:"absolute",left:`${Math.min(e.box.x,e.box.x+e.box.width)}px`,top:`${Math.min(e.box.y,e.box.y+e.box.height)}px`,width:`${Math.abs(e.box.width)}px`,height:`${Math.abs(e.box.height)}px`,border:"1px dashed var(--primary)",backgroundColor:"rgba(25, 118, 210, 0.1)",pointerEvents:"none",zIndex:1e3}));return(o,r)=>(g(),k("div",{class:"selection-box",style:Z(n.value)},null,4))}}),bn=te(yn,[["__scopeId","data-v-b6ef8827"]]),wn=["onClick"],kn={class:"menu-icon"},xn={class:"menu-label"},Sn=ee({__name:"ContextMenu",props:{x:{},y:{},items:{}},emits:["select","close"],setup(a,{emit:e}){const n=a,o=e,r=P(()=>({position:"fixed",left:`${n.x}px`,top:`${n.y}px`,zIndex:2e3}));function y($){$.type==="separator"||$.disabled||($.action&&o("select",$.action),o("close"))}function I($){o("close")}return ce(()=>{document.addEventListener("click",I),document.addEventListener("contextmenu",I)}),de(()=>{document.removeEventListener("click",I),document.removeEventListener("contextmenu",I)}),($,L)=>(g(),k("div",{class:"context-menu",style:Z(r.value),onClick:L[0]||(L[0]=he(()=>{},["stop"]))},[(g(!0),k(ne,null,ie($.items,(S,D)=>(g(),k("div",{key:D,class:le(["menu-item",{separator:S.type==="separator",disabled:S.disabled}]),onClick:T=>y(S)},[S.type!=="separator"?(g(),k(ne,{key:0},[t("span",kn,H(S.icon),1),t("span",xn,H(S.label),1)],64)):Y("",!0)],10,wn))),128))],4))}}),En=te(Sn,[["__scopeId","data-v-ff0fc2d6"]]),Cn={class:"toolbar-content"},$n=ee({__name:"ElementToolbar",props:{elements:{},position:{}},setup(a){const e=a,n=q(),o=P(()=>({position:"absolute",left:`${e.position.x}px`,top:`${e.position.y}px`,transform:"translateX(-50%)",zIndex:1e3})),r=P(()=>e.elements.some(m=>m.type==="text")),y=P(()=>e.elements.filter(m=>m.type==="text").every(m=>m.bold)),I=P(()=>e.elements.filter(m=>m.type==="text").every(m=>m.italic)),$=P(()=>e.elements.filter(m=>m.type==="text").every(m=>m.underline));async function L(){const m=e.elements.filter(_=>_.type==="text"),E=!y.value;for(const _ of m)await n.modifyElement(_.id,{bold:E})}async function S(){const m=e.elements.filter(_=>_.type==="text"),E=!I.value;for(const _ of m)await n.modifyElement(_.id,{italic:E})}async function D(){const m=e.elements.filter(_=>_.type==="text"),E=!$.value;for(const _ of m)await n.modifyElement(_.id,{underline:E})}async function T(){for(const m of e.elements)m.type==="text"&&await n.modifyElement(m.id,{align:"left"})}async function l(){for(const m of e.elements)m.type==="text"&&await n.modifyElement(m.id,{align:"center"})}async function s(){for(const m of e.elements)m.type==="text"&&await n.modifyElement(m.id,{align:"right"})}async function h(){const m=Math.max(...n.currentSlide.elements.map(E=>E.zIndex||1));for(const E of e.elements)await n.modifyElement(E.id,{zIndex:m+1})}async function j(){const m=Math.min(...n.currentSlide.elements.map(E=>E.zIndex||1));for(const E of e.elements)await n.modifyElement(E.id,{zIndex:Math.max(0,m-1)})}async function x(){n.copyElements(e.elements.map(m=>m.id)),await n.pasteElements()}async function p(){for(const m of e.elements)await n.removeElement(m.id);n.clearSelection()}return(m,E)=>(g(),k("div",{class:"element-toolbar",style:Z(o.value)},[t("div",Cn,[t("button",{class:"tool-btn",onClick:h,title:"Bring to Front"}," ⬆️ "),t("button",{class:"tool-btn",onClick:j,title:"Send to Back"}," ⬇️ "),E[4]||(E[4]=t("div",{class:"toolbar-separator"},null,-1)),r.value?(g(),k(ne,{key:0},[t("button",{class:le(["tool-btn",{active:y.value}]),onClick:L,title:"Bold"},E[0]||(E[0]=[t("strong",null,"B",-1)]),2),t("button",{class:le(["tool-btn",{active:I.value}]),onClick:S,title:"Italic"},E[1]||(E[1]=[t("em",null,"I",-1)]),2),t("button",{class:le(["tool-btn",{active:$.value}]),onClick:D,title:"Underline"},E[2]||(E[2]=[t("u",null,"U",-1)]),2),E[3]||(E[3]=t("div",{class:"toolbar-separator"},null,-1))],64)):Y("",!0),t("button",{class:"tool-btn",onClick:T,title:"Align Left"}," ⬅️ "),t("button",{class:"tool-btn",onClick:l,title:"Align Center"}," ↔️ "),t("button",{class:"tool-btn",onClick:s,title:"Align Right"}," ➡️ "),E[5]||(E[5]=t("div",{class:"toolbar-separator"},null,-1)),t("button",{class:"tool-btn",onClick:x,title:"Duplicate"}," 📋 "),t("button",{class:"tool-btn danger",onClick:p,title:"Delete"}," 🗑️ ")])],4))}}),In=te($n,[["__scopeId","data-v-0346b199"]]),_n={key:0,class:"canvas-grid"},An=ee({__name:"CanvasEditor",setup(a){const e=q(),n=ye(),o=F();F(!1),F({x:0,y:0});const r=F({visible:!1,x:0,y:0,width:0,height:0}),y=F({visible:!1,x:0,y:0}),I=P(()=>{var c;return((c=e.currentSlide)==null?void 0:c.elements)||[]}),$=P(()=>I.value.filter(c=>e.selectedElements.includes(c.id))),L=P(()=>({transform:`scale(${e.canvas.zoom})`,transformOrigin:"center center"})),S=P(()=>{const c=e.presentation.settings;return{width:`${c.width}px`,height:`${c.height}px`,transform:`translate(${e.canvas.offsetX}px, ${e.canvas.offsetY}px)`}}),D=P(()=>{var v,A,B,U,K;const c=(v=e.currentSlide)==null?void 0:v.background;if(!c)return{backgroundColor:"#ffffff"};switch(c.type){case"solid":return{backgroundColor:c.color};case"gradient":if(((A=c.gradient)==null?void 0:A.type)==="linear"){const me=c.gradient.colors.map(ue=>`${ue.color} ${ue.pos}%`).join(", ");return{background:`linear-gradient(${c.gradient.rotate||0}deg, ${me})`}}break;case"image":return{backgroundImage:`url(${(B=c.image)==null?void 0:B.src})`,backgroundSize:((U=c.image)==null?void 0:U.size)||"cover",backgroundPosition:((K=c.image)==null?void 0:K.position)||"center"}}return{backgroundColor:"#ffffff"}}),T=P(()=>[{label:"Add Text",action:"add-text",icon:"📝"},{label:"Add Image",action:"add-image",icon:"🖼️"},{label:"Add Shape",action:"add-shape",icon:"🔷"},{label:"Add Chart",action:"add-chart",icon:"📊"},{label:"Add Table",action:"add-table",icon:"📋"},{type:"separator"},{label:"Paste",action:"paste",icon:"📋",disabled:e.clipboard.length===0},{type:"separator"},{label:"AI Suggestions",action:"ai-suggestions",icon:"🤖"}]),l=P(()=>{if($.value.length===0)return{x:0,y:0};const c=z($.value);return{x:c.x+c.width/2,y:c.y-50}});function s(c){c.target===c.currentTarget&&(e.clearSelection(),j())}function h(c){c.preventDefault();const v=o.value.getBoundingClientRect();y.value={visible:!0,x:c.clientX-v.left,y:c.clientY-v.top}}function j(){y.value.visible=!1}async function x(c){j();const v=o.value.getBoundingClientRect(),A=o.value.querySelector(".slide-content").getBoundingClientRect(),B=(y.value.x-(A.left-v.left))/e.canvas.zoom,U=(y.value.y-(A.top-v.top))/e.canvas.zoom;switch(c){case"add-text":await Q(B,U);break;case"add-image":await b(B,U);break;case"add-shape":await i(B,U);break;case"add-chart":await d(B,U);break;case"add-table":await M(B,U);break;case"paste":await e.pasteElements();break;case"ai-suggestions":await n.generateSuggestions(e.canvas.activeSlide);break}}function p(c,v=!1){v?e.toggleElementSelection(c):e.selectElements([c])}function m(c){return e.selectedElements.includes(c)}async function E(c,v){await e.modifyElement(c,v)}async function _(c){await e.removeElement(c),e.clearSelection()}async function Q(c,v){await e.addText(e.canvas.activeSlide,{content:"Click to edit text",x:c-100,y:v-25,width:200,height:50,fontSize:16,color:"#333333"})}async function b(c,v){await e.addImage(e.canvas.activeSlide,{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgZmlsbD0iI2Y1ZjVmNSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiM5OTkiPkltYWdlIFBsYWNlaG9sZGVyPC90ZXh0Pjwvc3ZnPg==",x:c-100,y:v-75,width:200,height:150})}async function i(c,v){await e.addShape(e.canvas.activeSlide,{shape:"rectangle",x:c-50,y:v-25,width:100,height:50,fill:"#1976D2",stroke:"#1565C0",strokeWidth:2})}async function d(c,v){await e.addChart(e.canvas.activeSlide,{chartType:"bar",data:{labels:["Q1","Q2","Q3","Q4"],datasets:[{label:"Revenue",data:[30,45,60,80],backgroundColor:"#1976D2"}]},x:c-150,y:v-100,width:300,height:200})}async function M(c,v){await e.addTable(e.canvas.activeSlide,{rows:3,columns:3,data:[["Header 1","Header 2","Header 3"],["Row 1 Col 1","Row 1 Col 2","Row 1 Col 3"],["Row 2 Col 1","Row 2 Col 2","Row 2 Col 3"]],x:c-150,y:v-75,width:300,height:150})}function z(c){if(c.length===0)return{x:0,y:0,width:0,height:0};let v=1/0,A=1/0,B=-1/0,U=-1/0;for(const K of c)v=Math.min(v,K.left),A=Math.min(A,K.top),B=Math.max(B,K.left+K.width),U=Math.max(U,K.top+K.height);return{x:v,y:A,width:B-v,height:U-A}}function G(c){if(c.target===document.body)switch(c.key){case"Delete":case"Backspace":e.selectedElements.length>0&&(c.preventDefault(),e.selectedElements.forEach(v=>{_(v)}));break}}ce(()=>{document.addEventListener("keydown",G),xe(()=>{C()})}),de(()=>{document.removeEventListener("keydown",G)});function C(){if(!o.value)return;const v=o.value.getBoundingClientRect(),A=e.presentation.settings,B=(v.width-A.width*e.canvas.zoom)/2,U=(v.height-A.height*e.canvas.zoom)/2;e.setCanvasOffset(B,U)}return(c,v)=>(g(),k("div",{class:"canvas-editor",ref_key:"canvasContainer",ref:o},[t("div",{class:"canvas-background",style:Z(L.value),onClick:s,onContextmenu:h},[R(e).canvas.gridVisible?(g(),k("div",_n)):Y("",!0),t("div",{class:"slide-content",style:Z(S.value)},[t("div",{class:"slide-background",style:Z(D.value)},null,4),(g(!0),k(ne,null,ie(I.value,A=>(g(),ve(gn,{key:A.id,element:A,selected:m(A.id),zoom:R(e).canvas.zoom,onSelect:p,onUpdate:E,onDelete:_},null,8,["element","selected","zoom"]))),128)),r.value.visible?(g(),ve(bn,{key:0,box:r.value},null,8,["box"])):Y("",!0)],4)],36),y.value.visible?(g(),ve(En,{key:0,x:y.value.x,y:y.value.y,items:T.value,onSelect:x,onClose:j},null,8,["x","y","items"])):Y("",!0),$.value.length>0?(g(),ve(In,{key:1,elements:$.value,position:l.value},null,8,["elements","position"])):Y("",!0)],512))}}),Dn=te(An,[["__scopeId","data-v-cf51c8a0"]]),Tn={class:"element-properties"},Mn={class:"property-section"},Pn={class:"property-group"},Fn={class:"input-row"},Rn={class:"input-group"},On=["value"],zn={class:"input-group"},Ln=["value"],Bn={class:"input-row"},Nn={class:"input-group"},Hn=["value"],Yn={class:"input-group"},Un=["value"],jn={class:"input-row"},Vn={class:"input-group"},Xn=["value"],Zn={class:"input-group"},Wn=["value"],Gn={key:0,class:"property-group"},Jn=["value"],Kn={class:"input-row"},Qn={class:"input-group"},qn=["value"],eo={class:"input-group"},to=["value"],no={class:"input-row"},oo={class:"input-group"},so=["value"],io={class:"input-group"},lo=["value"],ao={class:"checkbox-row"},ro={class:"checkbox-label"},co=["checked"],uo={class:"checkbox-label"},po=["checked"],mo={class:"checkbox-label"},fo=["checked"],vo={key:1,class:"property-group"},ho={class:"input-row"},go={class:"input-group"},yo=["value"],bo={class:"input-group"},wo=["value"],ko={class:"checkbox-row"},xo={class:"checkbox-label"},So=["checked"],Eo={class:"checkbox-label"},Co=["checked"],$o={class:"checkbox-label"},Io=["checked"],_o={key:2,class:"property-group"},Ao={class:"input-row"},Do={class:"input-group"},To=["value"],Mo={class:"input-group"},Po=["value"],Fo={class:"input-row"},Ro={class:"input-group"},Oo=["value"],zo={key:3,class:"property-group"},Lo={class:"input-row"},Bo={class:"input-group"},No=["value"],Ho=ee({__name:"ElementProperties",props:{element:{}},setup(a){const e=a,n=q();async function o(l,s){await n.modifyElement(e.element.id,{[l]:s})}function r(l){return{text:"Text",image:"Image",shape:"Shape",chart:"Chart",table:"Table",video:"Video",audio:"Audio"}[l]||l}function y(l){return l.type!=="text"?"":l.content.replace(/<[^>]*>/g,"")}async function I(){const l=n.currentSlide;if(!l)return;const s=Math.max(...l.elements.map(h=>h.zIndex||1));await o("zIndex",s+1)}async function $(){const l=n.currentSlide;if(!l)return;const s=Math.min(...l.elements.map(h=>h.zIndex||1));await o("zIndex",Math.max(0,s-1))}async function L(){const l=e.element.zIndex||1;await o("zIndex",l+1)}async function S(){const l=e.element.zIndex||1;await o("zIndex",Math.max(0,l-1))}async function D(){n.copyElements([e.element.id]),await n.pasteElements()}async function T(){confirm("Delete this element?")&&(await n.removeElement(e.element.id),n.clearSelection())}return(l,s)=>(g(),k("div",Tn,[t("div",Mn,[t("h4",null,H(r(l.element.type)),1),t("div",Pn,[s[29]||(s[29]=t("label",null,"Position & Size",-1)),t("div",Fn,[t("div",Rn,[s[23]||(s[23]=t("label",null,"X",-1)),t("input",{type:"number",value:Math.round(l.element.left),onInput:s[0]||(s[0]=h=>o("left",Number(h.target.value)))},null,40,On)]),t("div",zn,[s[24]||(s[24]=t("label",null,"Y",-1)),t("input",{type:"number",value:Math.round(l.element.top),onInput:s[1]||(s[1]=h=>o("top",Number(h.target.value)))},null,40,Ln)])]),t("div",Bn,[t("div",Nn,[s[25]||(s[25]=t("label",null,"Width",-1)),t("input",{type:"number",value:Math.round(l.element.width),onInput:s[2]||(s[2]=h=>o("width",Number(h.target.value)))},null,40,Hn)]),t("div",Yn,[s[26]||(s[26]=t("label",null,"Height",-1)),t("input",{type:"number",value:Math.round(l.element.height),onInput:s[3]||(s[3]=h=>o("height",Number(h.target.value)))},null,40,Un)])]),t("div",jn,[t("div",Vn,[s[27]||(s[27]=t("label",null,"Rotation",-1)),t("input",{type:"number",value:Math.round(l.element.rotate),onInput:s[4]||(s[4]=h=>o("rotate",Number(h.target.value))),min:"0",max:"360"},null,40,Xn)]),t("div",Zn,[s[28]||(s[28]=t("label",null,"Opacity",-1)),t("input",{type:"range",value:(l.element.opacity||1)*100,onInput:s[5]||(s[5]=h=>o("opacity",Number(h.target.value)/100)),min:"0",max:"100"},null,40,Wn)])])]),l.element.type==="text"?(g(),k("div",Gn,[s[39]||(s[39]=t("label",null,"Text",-1)),t("textarea",{value:y(l.element),onInput:s[6]||(s[6]=h=>o("content",h.target.value)),rows:"3"},null,40,Jn),t("div",Kn,[t("div",Qn,[s[30]||(s[30]=t("label",null,"Font Size",-1)),t("input",{type:"number",value:l.element.fontSize||16,onInput:s[7]||(s[7]=h=>o("fontSize",Number(h.target.value))),min:"8",max:"72"},null,40,qn)]),t("div",eo,[s[32]||(s[32]=t("label",null,"Font Family",-1)),t("select",{value:l.element.fontFamily||"Arial",onChange:s[8]||(s[8]=h=>o("fontFamily",h.target.value))},s[31]||(s[31]=[$e('<option value="Arial" data-v-a5199387>Arial</option><option value="Helvetica" data-v-a5199387>Helvetica</option><option value="Times New Roman" data-v-a5199387>Times New Roman</option><option value="Georgia" data-v-a5199387>Georgia</option><option value="Verdana" data-v-a5199387>Verdana</option>',5)]),40,to)])]),t("div",no,[t("div",oo,[s[33]||(s[33]=t("label",null,"Color",-1)),t("input",{type:"color",value:l.element.color||l.element.defaultColor,onInput:s[9]||(s[9]=h=>o("color",h.target.value))},null,40,so)]),t("div",io,[s[35]||(s[35]=t("label",null,"Align",-1)),t("select",{value:l.element.align||"left",onChange:s[10]||(s[10]=h=>o("align",h.target.value))},s[34]||(s[34]=[t("option",{value:"left"},"Left",-1),t("option",{value:"center"},"Center",-1),t("option",{value:"right"},"Right",-1)]),40,lo)])]),t("div",ao,[t("label",ro,[t("input",{type:"checkbox",checked:l.element.bold||!1,onChange:s[11]||(s[11]=h=>o("bold",h.target.checked))},null,40,co),s[36]||(s[36]=oe(" Bold "))]),t("label",uo,[t("input",{type:"checkbox",checked:l.element.italic||!1,onChange:s[12]||(s[12]=h=>o("italic",h.target.checked))},null,40,po),s[37]||(s[37]=oe(" Italic "))]),t("label",mo,[t("input",{type:"checkbox",checked:l.element.underline||!1,onChange:s[13]||(s[13]=h=>o("underline",h.target.checked))},null,40,fo),s[38]||(s[38]=oe(" Underline "))])])])):Y("",!0),l.element.type==="image"?(g(),k("div",vo,[s[46]||(s[46]=t("label",null,"Image",-1)),t("div",ho,[t("div",go,[s[41]||(s[41]=t("label",null,"Fit",-1)),t("select",{value:l.element.fit||"contain",onChange:s[14]||(s[14]=h=>o("fit",h.target.value))},s[40]||(s[40]=[t("option",{value:"contain"},"Contain",-1),t("option",{value:"cover"},"Cover",-1),t("option",{value:"fill"},"Fill",-1)]),40,yo)]),t("div",bo,[s[42]||(s[42]=t("label",null,"Border Radius",-1)),t("input",{type:"number",value:l.element.borderRadius||0,onInput:s[15]||(s[15]=h=>o("borderRadius",Number(h.target.value))),min:"0"},null,40,wo)])]),t("div",ko,[t("label",xo,[t("input",{type:"checkbox",checked:l.element.shadow||!1,onChange:s[16]||(s[16]=h=>o("shadow",h.target.checked))},null,40,So),s[43]||(s[43]=oe(" Shadow "))]),t("label",Eo,[t("input",{type:"checkbox",checked:l.element.flipH||!1,onChange:s[17]||(s[17]=h=>o("flipH",h.target.checked))},null,40,Co),s[44]||(s[44]=oe(" Flip H "))]),t("label",$o,[t("input",{type:"checkbox",checked:l.element.flipV||!1,onChange:s[18]||(s[18]=h=>o("flipV",h.target.checked))},null,40,Io),s[45]||(s[45]=oe(" Flip V "))])])])):Y("",!0),l.element.type==="shape"?(g(),k("div",_o,[s[50]||(s[50]=t("label",null,"Shape",-1)),t("div",Ao,[t("div",Do,[s[47]||(s[47]=t("label",null,"Fill",-1)),t("input",{type:"color",value:l.element.fill||"#4CAF50",onInput:s[19]||(s[19]=h=>o("fill",h.target.value))},null,40,To)]),t("div",Mo,[s[48]||(s[48]=t("label",null,"Stroke",-1)),t("input",{type:"color",value:l.element.stroke||"#2E7D32",onInput:s[20]||(s[20]=h=>o("stroke",h.target.value))},null,40,Po)])]),t("div",Fo,[t("div",Ro,[s[49]||(s[49]=t("label",null,"Stroke Width",-1)),t("input",{type:"number",value:l.element.strokeWidth||2,onInput:s[21]||(s[21]=h=>o("strokeWidth",Number(h.target.value))),min:"0"},null,40,Oo)])])])):Y("",!0),l.element.type==="chart"?(g(),k("div",zo,[s[53]||(s[53]=t("label",null,"Chart",-1)),t("div",Lo,[t("div",Bo,[s[52]||(s[52]=t("label",null,"Type",-1)),t("select",{value:l.element.chartType,onChange:s[22]||(s[22]=h=>o("chartType",h.target.value))},s[51]||(s[51]=[$e('<option value="bar" data-v-a5199387>Bar</option><option value="line" data-v-a5199387>Line</option><option value="pie" data-v-a5199387>Pie</option><option value="doughnut" data-v-a5199387>Doughnut</option><option value="scatter" data-v-a5199387>Scatter</option><option value="area" data-v-a5199387>Area</option>',6)]),40,No)])])])):Y("",!0),t("div",{class:"property-group"},[s[54]||(s[54]=t("label",null,"Layer",-1)),t("div",{class:"button-row"},[t("button",{class:"btn btn-sm",onClick:I}," ⬆️ Front "),t("button",{class:"btn btn-sm",onClick:$}," ⬇️ Back "),t("button",{class:"btn btn-sm",onClick:L}," ↑ Forward "),t("button",{class:"btn btn-sm",onClick:S}," ↓ Backward ")])]),t("div",{class:"property-group"},[s[55]||(s[55]=t("label",null,"Actions",-1)),t("div",{class:"button-row"},[t("button",{class:"btn btn-sm",onClick:D}," 📋 Duplicate "),t("button",{class:"btn btn-sm btn-danger",onClick:T}," 🗑️ Delete ")])])])]))}}),Yo=te(Ho,[["__scopeId","data-v-a5199387"]]),Uo={class:"multi-element-properties"},jo={class:"property-group"},Vo={class:"alignment-grid"},Xo={class:"property-group"},Zo={class:"button-row"},Wo={class:"property-group"},Go={class:"input-row"},Jo={class:"input-group"},Ko={class:"input-group"},Qo={class:"property-group"},qo={class:"input-row"},es={class:"input-group"},ts=["value"],ns={class:"input-row"},os={class:"input-group"},ss=["value"],is={key:0,class:"property-group"},ls={class:"input-row"},as={class:"input-group"},rs=["value"],cs={class:"input-group"},ds=["value"],us={class:"checkbox-row"},ps={class:"checkbox-label"},ms=["checked"],fs={class:"checkbox-label"},vs=["checked"],hs=ee({__name:"MultiElementProperties",props:{elements:{}},setup(a){const e=a,n=q(),o=F({horizontal:20,vertical:20}),r=P(()=>e.elements.every(b=>b.type==="text")),y=P(()=>{const b=e.elements.map(i=>i.opacity||1);return b.every(i=>i===b[0])?b[0]:1}),I=P(()=>{const b=e.elements.map(i=>i.rotate);return b.every(i=>i===b[0])?b[0]:0}),$=P(()=>{if(!r.value)return 16;const b=e.elements.map(i=>i.fontSize||16);return b.every(i=>i===b[0])?b[0]:16}),L=P(()=>{if(!r.value)return"#333333";const b=e.elements.map(i=>i.color||i.defaultColor);return b.every(i=>i===b[0])?b[0]:"#333333"}),S=P(()=>{if(!r.value)return!1;const b=e.elements.map(i=>i.bold||!1);return b.every(i=>i===b[0])?b[0]:!1}),D=P(()=>{if(!r.value)return!1;const b=e.elements.map(i=>i.italic||!1);return b.every(i=>i===b[0])?b[0]:!1});async function T(b){const i=Q();for(const d of e.elements){let M=d.left,z=d.top;switch(b){case"left":M=i.left;break;case"center-h":M=i.left+(i.width-d.width)/2;break;case"right":M=i.left+i.width-d.width;break;case"top":z=i.top;break;case"center-v":z=i.top+(i.height-d.height)/2;break;case"bottom":z=i.top+i.height-d.height;break}await n.modifyElement(d.id,{left:M,top:z})}}async function l(b){if(e.elements.length<3)return;const i=[...e.elements].sort((v,A)=>b==="horizontal"?v.left-A.left:v.top-A.top),d=i[0],M=i[i.length-1],z=b==="horizontal"?M.left+M.width-d.left:M.top+M.height-d.top,G=i.reduce((v,A)=>v+(b==="horizontal"?A.width:A.height),0),C=(z-G)/(i.length-1);let c=b==="horizontal"?d.left:d.top;for(let v=1;v<i.length-1;v++){const A=i[v],B=i[v-1];c+=(b==="horizontal"?B.width:B.height)+C,await n.modifyElement(A.id,{[b==="horizontal"?"left":"top"]:c})}}async function s(){const b=[...e.elements].sort((i,d)=>i.left-d.left);for(let i=1;i<b.length;i++){const d=b[i-1],M=b[i];await n.modifyElement(M.id,{left:d.left+d.width+o.value.horizontal,top:d.top+o.value.vertical})}}async function h(b,i){for(const d of e.elements)await n.modifyElement(d.id,{[b]:i})}async function j(){const b=n.currentSlide;if(!b)return;const i=Math.max(...b.elements.map(d=>d.zIndex||1));for(const d of e.elements)await n.modifyElement(d.id,{zIndex:i+1})}async function x(){const b=n.currentSlide;if(!b)return;const i=Math.min(...b.elements.map(d=>d.zIndex||1));for(const d of e.elements)await n.modifyElement(d.id,{zIndex:Math.max(0,i-1)})}async function p(){const b=se();for(const i of e.elements)await n.modifyElement(i.id,{groupId:b})}async function m(){for(const b of e.elements)await n.modifyElement(b.id,{groupId:void 0})}async function E(){n.copyElements(e.elements.map(b=>b.id)),await n.pasteElements()}async function _(){if(confirm(`Delete ${e.elements.length} elements?`)){for(const b of e.elements)await n.removeElement(b.id);n.clearSelection()}}function Q(){let b=1/0,i=1/0,d=-1/0,M=-1/0;for(const z of e.elements)b=Math.min(b,z.left),i=Math.min(i,z.top),d=Math.max(d,z.left+z.width),M=Math.max(M,z.top+z.height);return{left:b,top:i,width:d-b,height:M-i}}return(b,i)=>(g(),k("div",Uo,[t("div",jo,[i[16]||(i[16]=t("label",null,"Alignment",-1)),t("div",Vo,[t("button",{class:"align-btn",onClick:i[0]||(i[0]=d=>T("left")),title:"Align Left"}," ⬅️ "),t("button",{class:"align-btn",onClick:i[1]||(i[1]=d=>T("center-h")),title:"Align Center"}," ↔️ "),t("button",{class:"align-btn",onClick:i[2]||(i[2]=d=>T("right")),title:"Align Right"}," ➡️ "),t("button",{class:"align-btn",onClick:i[3]||(i[3]=d=>T("top")),title:"Align Top"}," ⬆️ "),t("button",{class:"align-btn",onClick:i[4]||(i[4]=d=>T("center-v")),title:"Align Middle"}," ↕️ "),t("button",{class:"align-btn",onClick:i[5]||(i[5]=d=>T("bottom")),title:"Align Bottom"}," ⬇️ ")])]),t("div",Xo,[i[17]||(i[17]=t("label",null,"Distribution",-1)),t("div",Zo,[t("button",{class:"btn btn-sm",onClick:i[6]||(i[6]=d=>l("horizontal"))}," ↔️ Horizontal "),t("button",{class:"btn btn-sm",onClick:i[7]||(i[7]=d=>l("vertical"))}," ↕️ Vertical ")])]),t("div",Wo,[i[20]||(i[20]=t("label",null,"Spacing",-1)),t("div",Go,[t("div",Jo,[i[18]||(i[18]=t("label",null,"Horizontal",-1)),pe(t("input",{type:"number","onUpdate:modelValue":i[8]||(i[8]=d=>o.value.horizontal=d),onChange:s,min:"0"},null,544),[[ge,o.value.horizontal]])]),t("div",Ko,[i[19]||(i[19]=t("label",null,"Vertical",-1)),pe(t("input",{type:"number","onUpdate:modelValue":i[9]||(i[9]=d=>o.value.vertical=d),onChange:s,min:"0"},null,544),[[ge,o.value.vertical]])])])]),t("div",Qo,[i[23]||(i[23]=t("label",null,"Common Properties",-1)),t("div",qo,[t("div",es,[i[21]||(i[21]=t("label",null,"Opacity",-1)),t("input",{type:"range",value:y.value*100,onInput:i[10]||(i[10]=d=>h("opacity",Number(d.target.value)/100)),min:"0",max:"100"},null,40,ts)])]),t("div",ns,[t("div",os,[i[22]||(i[22]=t("label",null,"Rotation",-1)),t("input",{type:"number",value:I.value,onInput:i[11]||(i[11]=d=>h("rotate",Number(d.target.value))),min:"0",max:"360"},null,40,ss)])])]),r.value?(g(),k("div",is,[i[28]||(i[28]=t("label",null,"Text Properties",-1)),t("div",ls,[t("div",as,[i[24]||(i[24]=t("label",null,"Font Size",-1)),t("input",{type:"number",value:$.value,onInput:i[12]||(i[12]=d=>h("fontSize",Number(d.target.value))),min:"8",max:"72"},null,40,rs)]),t("div",cs,[i[25]||(i[25]=t("label",null,"Color",-1)),t("input",{type:"color",value:L.value,onInput:i[13]||(i[13]=d=>h("color",d.target.value))},null,40,ds)])]),t("div",us,[t("label",ps,[t("input",{type:"checkbox",checked:S.value,onChange:i[14]||(i[14]=d=>h("bold",d.target.checked))},null,40,ms),i[26]||(i[26]=oe(" Bold "))]),t("label",fs,[t("input",{type:"checkbox",checked:D.value,onChange:i[15]||(i[15]=d=>h("italic",d.target.checked))},null,40,vs),i[27]||(i[27]=oe(" Italic "))])])])):Y("",!0),t("div",{class:"property-group"},[i[29]||(i[29]=t("label",null,"Layer",-1)),t("div",{class:"button-row"},[t("button",{class:"btn btn-sm",onClick:j}," ⬆️ Front "),t("button",{class:"btn btn-sm",onClick:x}," ⬇️ Back ")])]),t("div",{class:"property-group"},[i[30]||(i[30]=t("label",null,"Group",-1)),t("div",{class:"button-row"},[t("button",{class:"btn btn-sm",onClick:p}," 🔗 Group "),t("button",{class:"btn btn-sm",onClick:m}," 🔓 Ungroup ")])]),t("div",{class:"property-group"},[i[31]||(i[31]=t("label",null,"Actions",-1)),t("div",{class:"button-row"},[t("button",{class:"btn btn-sm",onClick:E}," 📋 Duplicate "),t("button",{class:"btn btn-sm btn-danger",onClick:_}," 🗑️ Delete ")])])]))}}),gs=te(hs,[["__scopeId","data-v-fd28974b"]]),ys={class:"property-panel"},bs={class:"panel-content"},ws={key:0,class:"no-selection"},ks={key:1,class:"single-element"},xs={key:2,class:"multiple-elements"},Ss={class:"selection-info"},Es=ee({__name:"PropertyPanel",setup(a){const e=q(),n=P(()=>{const o=e.currentSlide;return o?o.elements.filter(r=>e.selectedElements.includes(r.id)):[]});return(o,r)=>(g(),k("div",ys,[r[1]||(r[1]=t("div",{class:"panel-header"},[t("h3",null,"Properties")],-1)),t("div",bs,[n.value.length===0?(g(),k("div",ws,r[0]||(r[0]=[t("div",{class:"no-selection-icon"},"🎯",-1),t("p",null,"Select an element to edit its properties",-1)]))):n.value.length===1?(g(),k("div",ks,[re(Yo,{element:n.value[0]},null,8,["element"])])):(g(),k("div",xs,[t("div",Ss,[t("strong",null,H(n.value.length)+" elements selected",1)]),re(gs,{elements:n.value},null,8,["elements"])]))])]))}}),Cs=te(Es,[["__scopeId","data-v-17f16050"]]),$s={class:"ai-suggestions-overlay"},Is={class:"suggestions-container"},_s={class:"suggestions-header"},As={class:"suggestions-content"},Ds=["onClick"],Ts={class:"suggestion-icon"},Ms={class:"suggestion-details"},Ps={class:"suggestion-title"},Fs={class:"suggestion-description"},Rs={class:"suggestion-confidence"},Os={class:"suggestion-actions"},zs=["onClick"],Ls=["onClick"],Bs={class:"suggestions-footer"},Ns=ee({__name:"AISuggestions",setup(a){const e=ye(),n=q();async function o(S){try{await e.executeAISuggestion(S)}catch(D){console.error("Failed to apply suggestion:",D)}}function r(S){e.aiSuggestions.splice(S,1)}async function y(){await e.generateSuggestions(n.canvas.activeSlide)}function I(S){const D={ADD:{text:"📝",image:"🖼️",shape:"🔷",chart:"📊",table:"📋"},MODIFY:"✏️",CREATE:"➕",DELETE:"🗑️",REMOVE:"❌",REORDER:"🔄",APPLY:"🎨"};return S.op==="ADD"&&typeof S.type=="string"?D.ADD[S.type]||"➕":D[S.op]||"💡"}function $(S){const D={ADD:"Add",REMOVE:"Remove",MODIFY:"Modify",CREATE:"Create",DELETE:"Delete",REORDER:"Reorder",APPLY:"Apply"},T={text:"Text",image:"Image",shape:"Shape",chart:"Chart",table:"Table",slide:"Slide",theme:"Theme"};return`${D[S.op]} ${T[S.type]||S.type}`}function L(S){switch(S.op){case"ADD":switch(S.type){case"text":return"Add a title or content text to improve slide structure";case"image":return"Add a relevant image to enhance visual appeal";case"shape":return"Add a shape to create visual hierarchy";case"chart":return"Add a chart to visualize data effectively";case"table":return"Add a table to organize information clearly";default:return`Add a new ${S.type} element`}case"MODIFY":return"Improve styling and positioning for better visual impact";case"CREATE":return"Create a new slide with optimized layout";case"APPLY":return S.type==="theme"?"Apply a cohesive theme for professional appearance":`Apply ${S.type} improvements`;case"REORDER":return"Reorganize elements for better flow and readability";default:return`AI suggests this ${S.op.toLowerCase()} operation`}}return(S,D)=>(g(),k("div",$s,[t("div",Is,[t("div",_s,[D[2]||(D[2]=t("h3",null,"🤖 AI Suggestions",-1)),t("button",{class:"close-btn",onClick:D[0]||(D[0]=T=>R(e).clearSuggestions())},"×")]),t("div",As,[(g(!0),k(ne,null,ie(R(e).aiSuggestions,(T,l)=>(g(),k("div",{key:l,class:"suggestion-card",onClick:s=>o(T)},[t("div",Ts,H(I(T)),1),t("div",Ms,[t("div",Ps,H($(T)),1),t("div",Fs,H(L(T)),1),t("div",Rs," Confidence: "+H(Math.round(T.confidence*100)||85)+"% ",1)]),t("div",Os,[t("button",{class:"action-btn apply-btn",onClick:he(s=>o(T),["stop"])}," Apply ",8,zs),t("button",{class:"action-btn dismiss-btn",onClick:he(s=>r(l),["stop"])}," × ",8,Ls)])],8,Ds))),128))]),t("div",Bs,[t("button",{class:"btn btn-ghost btn-sm",onClick:D[1]||(D[1]=T=>R(e).clearSuggestions())}," Dismiss All "),t("button",{class:"btn btn-primary btn-sm",onClick:y}," Generate More ")])])]))}}),Hs=te(Ns,[["__scopeId","data-v-72420aa8"]]),Ys={class:"editor"},Us={class:"editor-header"},js={class:"header-left"},Vs={class:"presentation-title"},Xs={class:"header-center"},Zs={class:"header-right"},Ws={class:"editor-content"},Gs={class:"sidebar-left"},Js={class:"canvas-area"},Ks={class:"canvas-container"},Qs={class:"zoom-controls"},qs={class:"zoom-level"},ei={class:"sidebar-right"},ti={class:"status-bar"},ni={class:"status-left"},oi={class:"status-item"},si={key:0,class:"status-item"},ii={key:1,class:"status-item"},li={class:"status-right"},ai={class:"status-item"},ri={class:"status-item"},ci=ee({__name:"Editor",setup(a){const e=q(),n=ye();ce(()=>{document.addEventListener("keydown",o);const l=window.location.pathname.split("/")[2];l&&D(l),setInterval(T,3e4)}),de(()=>{document.removeEventListener("keydown",o)});function o(l){if(l.ctrlKey||l.metaKey)switch(l.key){case"z":l.preventDefault(),l.shiftKey?e.redo():e.undo();break;case"c":l.preventDefault(),e.selectedElements.length>0&&e.copyElements(e.selectedElements);break;case"v":l.preventDefault(),e.pasteElements();break;case"s":l.preventDefault(),T();break;case"n":l.preventDefault(),e.createSlide();break}switch(l.key){case"Delete":case"Backspace":e.selectedElements.length>0&&(l.preventDefault(),e.selectedElements.forEach(h=>{e.removeElement(h)}),e.clearSelection());break;case"ArrowLeft":(l.ctrlKey||l.metaKey)&&(l.preventDefault(),$());break;case"ArrowRight":(l.ctrlKey||l.metaKey)&&(l.preventDefault(),L());break;case"Escape":e.clearSelection();break}}function r(){e.setZoom(e.canvas.zoom*1.2)}function y(){e.setZoom(e.canvas.zoom/1.2)}function I(){e.setZoom(1),e.setCanvasOffset(0,0)}function $(){const l=Math.max(0,e.canvas.activeSlide-1);e.setActiveSlide(l)}function L(){const l=Math.min(e.totalSlides-1,e.canvas.activeSlide+1);e.setActiveSlide(l)}function S(){console.log("Starting presentation...")}async function D(l){try{const s=await fetch(`/api/presentations/${l}`);if(s.ok){const h=await s.json();e.loadPresentation(h)}}catch(s){console.error("Failed to load presentation:",s)}}async function T(){try{const l=e.exportPresentation();(await fetch(`/api/presentations/${l.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})).ok&&console.log("✅ Auto-saved presentation")}catch(l){console.warn("Auto-save failed:",l)}}return(l,s)=>(g(),k("div",Ys,[t("header",Us,[t("div",js,[s[1]||(s[1]=t("div",{class:"logo"},[t("span",{class:"logo-icon"},"🎯"),t("span",{class:"logo-text"},"AI-PPT")],-1)),t("div",Vs,[pe(t("input",{"onUpdate:modelValue":s[0]||(s[0]=h=>R(e).presentation.title=h),class:"title-input",placeholder:"Presentation Title"},null,512),[[ge,R(e).presentation.title]])])]),t("div",Xs,[re(rt)]),t("div",Zs,[re(Ht),t("button",{class:"btn btn-primary",onClick:S},s[2]||(s[2]=[t("span",null,"▶",-1),oe(" Present ")]))])]),t("div",Ws,[t("aside",Gs,[re(on)]),t("main",Js,[t("div",Ks,[re(Dn)]),t("div",Qs,[t("button",{class:"btn btn-sm",onClick:y},"-"),t("span",qs,H(Math.round(R(e).canvas.zoom*100))+"%",1),t("button",{class:"btn btn-sm",onClick:r},"+"),t("button",{class:"btn btn-sm",onClick:I},"Fit")])]),t("aside",ei,[re(Cs)])]),t("footer",ti,[t("div",ni,[t("span",oi," Slide "+H(R(e).canvas.activeSlide+1)+" of "+H(R(e).totalSlides),1),R(n).isAIReady?(g(),k("span",si," 🤖 AI Ready ")):Y("",!0),R(n).suggestionCount>0?(g(),k("span",ii," 💡 "+H(R(n).suggestionCount)+" suggestions ",1)):Y("",!0)]),t("div",li,[t("span",ai,H(R(e).getPerformanceMetrics().totalOperations||0)+" operations ",1),t("span",ri,H(R(e).presentation.settings.width)+"×"+H(R(e).presentation.settings.height),1)])]),R(n).suggestionCount>0?(g(),ve(Hs,{key:0})):Y("",!0)]))}}),De=te(ci,[["__scopeId","data-v-b2d15c7e"]]),di=Le({history:Be(),routes:[{path:"/",name:"Editor",component:De},{path:"/presentation/:id",name:"Presentation",component:De,props:!0}]}),Se=Ne(Ge);Se.use(Ze);Se.use(di);Se.mount("#app");Se.config.errorHandler=(a,e,n)=>{console.error("Global error:",a,n)};
//# sourceMappingURL=index-CDCUOr-A.js.map
